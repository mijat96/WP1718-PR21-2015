<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>

    <script src="Scripts/jquery-1.10.2.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            let primljeno = localStorage.getItem("logovan");
            let dataP;
            $.ajax({
                type: 'POST',
                url: '/api/Start',
                data: JSON.stringify(primljeno),
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                async: false,
                success: function (data) {
                    dataP = data;

                    let timerId = setInterval(
                        function check() {
                            if (dataP.Uloga == 1) {
                                $.ajax({
                                    type: 'GET',
                                    url: '/api/Musterija/' + dataP.Id,
                                    async: false,
                                    success: function (data) {
                                        if (data.Banovan == true)
                                            $(location).attr('href', 'LogovanjeRegistracija.html');
                                    }
                                })
                            }
                            if (dataP.Uloga == 2) {
                                $.ajax({
                                    type: 'GET',
                                    url: '/api/Vozac/' + dataP.Id,
                                    async: false,
                                    success: function (data) {
                                        if (data.Banovan == true)
                                            $(location).attr('href', 'LogovanjeRegistracija.html');
                                    }
                                })
                            }
                        },
                        2000);

                    if (data != null) {

                        if (data.Uloga == 0) {
                            $("#divDispecer").show();
                            $("#divKorisnik").hide();
                            $("#divVozac").hide();
                            $("#IzmjenaKorisnik1").hide();
                            $("#DodavanjeVozaca").hide();
                            $("#DodavanjeVoznjeDispecer").hide();
                            $("#PrikaziVoznjeDispecer").hide();
                            $("#PrikaziFiltriraneVoznjeDisp").hide();
                            $("#PrikaziFiltriraneVoznjeSveDisp").hide();
                            $("#PrikazMusterijaZaBan").hide();
                            $("#PrikazVozacaZaBan").hide();
                            $("#map").hide();

                        } else if (data.Uloga == 1) {
                            $("#divKorisnik").show();
                            $("#DodavanjeVoznjeMusterija").hide();
                            $("#divDispecer").hide();
                            $("#divVozac").hide();
                            $("#IzmjenaKorisnik").hide();
                            $("#PrikaziVoznjeMusterije").hide();
                            $("#IzmjenaVoznja").hide();
                            $("#KomentarVoznja").hide();
                            $("#PrikaziFiltriraneVoznjeMust").hide();
                            $("#PrikaziSortiraneVoznjeMust").hide();
                            $("#map").hide();


                        } else {
                            $("#divVozac").show();
                            $("#divKorisnik").hide();
                            $("#divDispecer").hide();
                            $("#IzmjenaKorisnik2").hide();
                            $("#PrikaziVoznjeVozac").hide();
                            $("#KomentarNeuspjesnaVoznja").hide();
                            $("#PrikaziKreiraneVoznjeVozac").hide();
                            $("#PrikaziFiltriraneVoznjeVozac").hide();
                            $("#UspjesnaVoznjaNoComm").hide();
                            $("#PretraziMusterijuDatum").hide();
                            $("#PrikazPretrPoDatMust").hide();
                            $("#map").hide();

                        }
                    } else {
                        alert('Neuspjesno slanje.');
                    }
                },
            })








            $("#prikaziKorisnik").click(function () {
                $("#PrikaziVoznjeMusterije").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#IzmjenaKorisnik").hide();
                $("#PrikazKorisnik").show();
                $("#IzmjenaVoznja").hide();
                $("#KomentarVoznja").hide();
                $("#PretraziMusterijuDatum").hide();
                $("#PrikaziFiltriraneVoznjeMust").hide();
                $("#PrikaziSortiraneVoznjeMust").hide();
                $("#PrikazPretrPoDatMust").hide();
                $("#map").hide();

                let tableofData = "<table border='1'>";
                tableofData += `<tr><td>Id</td><td>${dataP.Id}</td></tr>`;
                tableofData += `<tr><td>Korisnicko ime</td><td>${dataP.KorisnickoIme}</td></tr>`;
                tableofData += `<tr><td>Lozinka</td><td>${dataP.Lozinka}</td></tr>`;
                tableofData += `<tr><td>Ime</td><td>${dataP.Ime}</td></tr>`;
                tableofData += `<tr><td>Prezime</td><td>${dataP.Prezime}</td></tr>`;
                tableofData += `<tr><td>JMBG</td><td>${dataP.JMBG}</td></tr>`;
                tableofData += `<tr><td>Kontakt telefon</td><td>${dataP.KontaktTelefon}</td></tr>`;
                tableofData += `<tr><td>Email</td><td>${dataP.Email}</td></tr>`;
                tableofData += "</table>";
                $("#PrikazKorisnik").html(tableofData);

            });

            $("#prikaziKorisnik1").click(function () {
                $("#IzmjenaKorisnik1").hide();
                $("#PrikazKorisnik1").show();
                $("#DodavanjeVozaca").hide();
                $("#DodavanjeVoznjeDispecer").hide();
                $("#PrikaziVoznjeDispecer").hide();
                $("#PrikazVozacaZaBan").hide();
                $("#PrikazMusterijaZaBan").hide();
                $("#PrikaziFiltriraneVoznjeSveDisp").hide();
                $("#PrikaziFiltriraneVoznjeDisp").hide();
                $("#PrikaziVoznjeDispecerSve").hide();
                $("#map").hide();

                let tableofData = "<table border='1'>";
                tableofData += `<tr><td>Id</td><td>${dataP.Id}</td></tr>`;
                tableofData += `<tr><td>Korisnicko ime</td><td>${dataP.KorisnickoIme}</td></tr>`;
                tableofData += `<tr><td>Lozinka</td><td>${dataP.Lozinka}</td></tr>`;
                tableofData += `<tr><td>Ime</td><td>${dataP.Ime}</td></tr>`;
                tableofData += `<tr><td>Prezime</td><td>${dataP.Prezime}</td></tr>`;
                tableofData += `<tr><td>JMBG</td><td>${dataP.JMBG}</td></tr>`;
                tableofData += `<tr><td>Kontakt telefon</td><td>${dataP.KontaktTelefon}</td></tr>`;
                tableofData += `<tr><td>Email</td><td>${dataP.Email}</td></tr>`;
                tableofData += "</table>";
                $("#PrikazKorisnik1").html(tableofData);

            });


            $("#prikaziKorisnik2").click(function () {
                $("#IzmjenaKorisnik2").hide();
                $("#PrikazKorisnik2").show();
                $("#PrikaziVoznjeVozac").hide();
                $("#KomentarNeuspjesnaVoznja").hide();
                $("#PrikaziKreiraneVoznjeVozac").hide();
                $("#UspjesnaVoznjaNoComm").hide();
                $("#PrikaziFiltriraneVoznjeVozac").hide();
                $("#map").hide();

                let tableofData = "<table border='1'>";
                tableofData += `<tr><td>Id</td><td>${dataP.Id}</td></tr>`;
                tableofData += `<tr><td>Korisnicko ime</td><td>${dataP.KorisnickoIme}</td></tr>`;
                tableofData += `<tr><td>Lozinka</td><td>${dataP.Lozinka}</td></tr>`;
                tableofData += `<tr><td>Ime</td><td>${dataP.Ime}</td></tr>`;
                tableofData += `<tr><td>Prezime</td><td>${dataP.Prezime}</td></tr>`;
                tableofData += `<tr><td>JMBG</td><td>${dataP.JMBG}</td></tr>`;
                tableofData += `<tr><td>Kontakt telefon</td><td>${dataP.KontaktTelefon}</td></tr>`;
                tableofData += `<tr><td>Email</td><td>${dataP.Email}</td></tr>`;
                tableofData += `<tr><td>Zauzet</td><td>${dataP.Zauzet}</td></tr>`;
                tableofData += `<tr><td>Id lokacije</td><td>${dataP.Lokacija.IdLok}</td></tr>`;
                tableofData += `<tr><td>X</td><td>${dataP.Lokacija.X}</td></tr>`;
                tableofData += `<tr><td>Y</td><td>${dataP.Lokacija.Y}</td></tr>`;
                tableofData += `<tr><td>Ulica i broj</td><td>${dataP.Lokacija.Adresa.UlicaIBroj}</td></tr>`;
                tableofData += `<tr><td>Naseljeno mjesto</td><td>${dataP.Lokacija.Adresa.IdAdr}</td></tr>`;
                tableofData += `<tr><td>Naseljeno mjesto</td><td>${dataP.Lokacija.Adresa.NaseljenoMjesto}</td></tr>`;
                tableofData += `<tr><td>Pozivni broj</td><td>${dataP.Lokacija.Adresa.PozivniBroj}</td></tr>`;
                tableofData += `<tr><td>Id vozaca</td><td>${dataP.Automobil.IdVozaca}</td></tr>`;
                tableofData += `<tr><td>Godiste</td><td>${dataP.Automobil.Godiste}</td></tr>`;
                tableofData += `<tr><td>Registracija</td><td>${dataP.Automobil.Registracija}</td></tr>`;
                tableofData += `<tr><td>Broj vozila</td><td>${dataP.Automobil.BrojVozila}</td></tr>`;
                if (dataP.Automobil.TipAuta == 1) {
                    tableofData += `<tr><td>Tip automobila</td><td>Kombi</td></tr>`;
                } else {
                    tableofData += `<tr><td>Tip automobila</td><td>Putnicki</td></tr>`;
                }
                tableofData += "</table>";
                $("#PrikazKorisnik2").html(tableofData);

            });


            $("#izmjeniKorisnik").click(function () {
                $("#PrikaziVoznjeMusterije").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#IzmjenaKorisnik").show();
                $("#PrikazKorisnik").hide();
                $("#IzmjenaVoznja").hide();
                $("#KomentarVoznja").hide();
                $("#PrikaziFiltriraneVoznjeMust").hide();
                $("#PretraziMusterijuDatum").hide();
                $("#PrikazPretrPoDatMust").hide();
                $("#PrikaziSortiraneVoznjeMust").hide();
                $("#map").hide();


                let tableofData = "<table border='1'>";
                tableofData += "<tr><td>Korisnicko ime</td><td><input id=\"korImeReg\" type=\"text\" name=\"KorisnickoIme\" value=\"" + dataP.KorisnickoIme + "\"/></td></tr>";
                tableofData += "<tr><td>Lozinka</td><td><input id=\"korPassReg\" type=\"password\" name=\"Lozinka\" value=\"" + dataP.Lozinka + "\"/></td></tr>";
                tableofData += "<tr><td>Ime</td><td><input id=\"ime\" type=\"text\" name=\"Ime\" value=\"" + dataP.Ime + "\"/></td></tr>";
                tableofData += "<tr><td>Prezime</td><td><input id=\"prezime\" type=\"text\" name=\"Prezime\" value=\"" + dataP.Prezime + "\"/></td></tr>";
                tableofData += "<tr><td>JMBG</td><td><input id=\"jmbg\" type=\"text\" name=\"JMBG\" value=\"" + dataP.JMBG + "\"/></td></tr>";
                tableofData += "<tr><td>Email</td><td><input id=\"email\" type=\"email\" name=\"Email\" value=\"" + dataP.Email + "\"/></td></tr>";
                tableofData += "<tr><td>Kontakt telefon</td><td><input id=\"brTelefona\" type=\"text\" name=\"KontaktTelefon\" value=\"" + dataP.KontaktTelefon + "\"/></td></tr>";
                tableofData += "</table>";
                $("#IzmjenaShow").html(tableofData);

            });

            $("#izmjeniKorisnik1").click(function () {
                $("#IzmjenaKorisnik1").show();
                $("#PrikazKorisnik1").hide();
                $("#DodavanjeVozaca").hide();
                $("#DodavanjeVoznjeDispecer").hide();
                $("#PrikaziFiltriraneVoznjeDisp").hide();
                $("#PrikazMusterijaZaBan").hide();
                $("#PrikazVozacaZaBan").hide();
                $("#PrikaziVoznjeDispecer").hide();
                $("#PrikaziFiltriraneVoznjeSveDisp").hide();
                $("#PrikaziVoznjeDispecerSve").hide();
                $("#map").hide();

                let tableofData = "<table border='1'>";
                tableofData += "<tr><td>Korisnicko ime</td><td><input id=\"korImeReg\" type=\"text\" name=\"KorisnickoIme\" value=\"" + dataP.KorisnickoIme + "\"/></td></tr>";
                tableofData += "<tr><td>Lozinka</td><td><input id=\"korPassReg\" type=\"password\" name=\"Lozinka\" value=\"" + dataP.Lozinka + "\"/></td></tr>";
                tableofData += "<tr><td>Ime</td><td><input id=\"ime\" type=\"text\" name=\"Ime\" value=\"" + dataP.Ime + "\"/></td></tr>";
                tableofData += "<tr><td>Prezime</td><td><input id=\"prezime\" type=\"text\" name=\"Prezime\" value=\"" + dataP.Prezime + "\"/></td></tr>";
                tableofData += "<tr><td>JMBG</td><td><input id=\"jmbg\" type=\"text\" name=\"JMBG\" value=\"" + dataP.JMBG + "\"/></td></tr>";
                tableofData += "<tr><td>Email</td><td><input id=\"email\" type=\"email\" name=\"Email\" value=\"" + dataP.Email + "\"/></td></tr>";
                tableofData += "<tr><td>Kontakt telefon</td><td><input id=\"brTelefona\" type=\"text\" name=\"KontaktTelefon\" value=\"" + dataP.KontaktTelefon + "\"/></td></tr>";
                tableofData += "</table>";
                $("#IzmjenaShow1").html(tableofData);

            });


            $("#izmjeniKorisnik2").click(function () {
                $("#IzmjenaKorisnik2").show();
                $("#PrikazKorisnik2").hide();
                $("#PrikaziVoznjeVozac").hide();
                $("#KomentarNeuspjesnaVoznja").hide();
                $("#PrikaziKreiraneVoznjeVozac").hide();
                $("#PrikaziFiltriraneVoznjeVozac").hide();
                $("#UspjesnaVoznjaNoComm").hide();
                $("#map").hide();

                let tableofData = "<table border='1'>";
                tableofData += "<tr><td>Korisnicko ime</td><td><input id=\"korImeReg2\" type=\"text\" name=\"KorisnickoIme\" value=\"" + dataP.KorisnickoIme + "\"/></td></tr>";
                tableofData += "<tr><td>Lozinka</td><td><input id=\"korPassReg2\" type=\"password\" name=\"Lozinka\" value=\"" + dataP.Lozinka + "\"/></td></tr>";
                tableofData += "<tr><td>Ime</td><td><input id=\"ime2\" type=\"text\" name=\"Ime\" value=\"" + dataP.Ime + "\"/></td></tr>";
                tableofData += "<tr><td>Prezime</td><td><input id=\"prezime2\" type=\"text\" name=\"Prezime\" value=\"" + dataP.Prezime + "\"/></td></tr>";
                tableofData += "<tr><td>JMBG</td><td><input id=\"jmbg2\" type=\"text\" name=\"JMBG\" value=\"" + dataP.JMBG + "\"/></td></tr>";
                tableofData += "<tr><td>Email</td><td><input id=\"email2\" type=\"email\" name=\"Email\" value=\"" + dataP.Email + "\"/></td></tr>";
                tableofData += "<tr><td>Kontakt telefon</td><td><input id=\"brTelefona2\" type=\"text\" name=\"KontaktTelefon\" value=\"" + dataP.KontaktTelefon + "\"/></td></tr>";
                tableofData += "<tr><td>Id lokacije</td><td><input id=\"idlokacije2\" type=\"text\" name=\"IdLok\" value=\"" + dataP.Lokacija.IdLok + "\"/></td></tr>";
                tableofData += "<tr><td>X </td><td><input id=\"x2\" type=\"text\" name=\"X\" value=\"" + dataP.Lokacija.X + "\"/></td></tr>";
                tableofData += "<tr><td>Y </td><td><input id=\"y2\" type=\"text\" name=\"Y\" value=\"" + dataP.Lokacija.Y + "\"/></td></tr>";
                tableofData += "<tr><td>Id adrese</td><td><input id=\"idadrese2\" type=\"text\" name=\"IdAdr\" value=\"" + dataP.Lokacija.Adresa.IdAdr + "\"/></td></tr>";
                tableofData += "<tr><td>Ulica i broj</td><td><input id=\"ulicaibroj2\" type=\"text\" name=\"UlicaIBroj\" value=\"" + dataP.Lokacija.Adresa.UlicaIBroj + "\"/></td></tr>";
                tableofData += "<tr><td>Naseljeno mjesto</td><td><input id=\"naseljenomjesto2\" type=\"text\" name=\"NaseljenoMjesto\" value=\"" + dataP.Lokacija.Adresa.NaseljenoMjesto + "\"/></td></tr>";
                tableofData += "<tr><td>Pozivni broj</td><td><input id=\"pozivnibroj2\" type=\"text\" name=\"PozivniBroj\" value=\"" + dataP.Lokacija.Adresa.PozivniBroj + "\"/></td></tr>";
                tableofData += "<tr><td>Godiste automobila</td><td><input id=\"godiste2\" type=\"text\" name=\"Godiste\" value=\"" + dataP.Automobil.Godiste + "\"/></td></tr>";
                tableofData += "<tr><td>Registracija</td><td><input id=\"registracija2\" type=\"text\" name=\"Registracija\" value=\"" + dataP.Automobil.Registracija + "\"/></td></tr>";
                tableofData += "<tr><td>Broj vozila</td><td><input id=\"brojvozila2\" type=\"text\" name=\"BrojVozila\" value=\"" + dataP.Automobil.BrojVozila + "\"/></td></tr>";
                tableofData += "</table>";
                $("#IzmjenaShow2").html(tableofData);

            });




            $(document).on('click', '#izmjeniVoznja', function () {
                let fired_button = $(this).val();
                localStorage.setItem("voznjaIzmjena", fired_button);
                $("#IzmjenaKorisnik").hide();
                $("#PrikazKorisnik").hide();
                $("#IzmjenaVoznja").show();
                $("#PrikaziVoznjeMusterije").show();
                $("#PrikaziFiltriraneVoznjeMust").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#PrikaziVoznjeDispecer").hide();
                $("#PretraziMusterijuDatum").hide();
                $("#PrikaziVoznjeDispecerSve").hide();
                $("#PrikazPretrPoDatMust").hide();
                $("#PrikaziSortiraneVoznjeMust").hide();
                $("#map").show();


                $.get("/api/Voznja", function (data, status) {
                    let id = localStorage.getItem("voznjaIzmjena");
                    let tableofData2 = "<table border='1'>";
                    for (voznja in data) {
                        if (data[voznja].IdVoznje == id) {
                            tableofData2 +=
                                "<tr><td>Id lokacije dolaska</td><td><input id=\"idlok1\" type=\"text\" name=\"IdLok\" value=\"" + data[voznja].Dolazak.Adresa.IdLok + "\"/></td></tr>" +
                                "<tr><td>X lokacije dolaska</td><td><input id=\"x1\" type=\"text\" name=\"X\" value=\"" + data[voznja].Dolazak.X + "\"/></td></tr>" +
                                "<tr><td>Y lokacije dolaska</td><td><input id=\"y1\" type=\"text\" name=\"Y\" value=\"" + data[voznja].Dolazak.Y + "\"/></td></tr>" +
                                "<tr><td>Id adrese dolaska</td><td><input id=\"idadr1\" type=\"text\" name=\"IdAdr\" value=\"" + data[voznja].Dolazak.Adresa.IdAdr + "\"/></td></tr>" +
                                "<tr><td>Ulica i broj lokacije dolaska</td><td><input id=\"ulicaibroj1\" type=\"text\" name=\"UlicaIBroj\" value=\"" + data[voznja].Dolazak.Adresa.UlicaIBroj + "\"/></td></tr>" +
                                "<tr><td>Naseljeno mjesto lokacije dolaska</td><td><input id=\"naseljenomjesto1\" type=\"text\" name=\"NaseljenoMjesto\" value=\"" + data[voznja].Dolazak.Adresa.NaseljenoMjesto + "\"/></td></tr>" +
                                "<tr><td>Pozivni broj lokacije dolaska</td><td><input id=\"pozivnibroj1\" type=\"text\" name=\"PozivniBroj\" value=\"" + data[voznja].Dolazak.Adresa.PozivniBroj + "\"/></td></tr>";
                        }
                    }
                    tableofData2 += "</table>";
                    $("#IzmjenaShow3").html(tableofData2);
                });
            });




            $(document).on('click', '#otkaziVoznja', function () {
                let fired_button1 = $(this).val();
                localStorage.setItem("voznjaOtkaz", fired_button1);
                $("#IzmjenaKorisnik").hide();
                $("#PrikazKorisnik").hide();
                $("#IzmjenaVoznja").hide();
                $("#PrikaziVoznjeMusterije").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#KomentarVoznja").show();
                $("#PrikaziFiltriraneVoznjeMust").hide();
                $("#PretraziMusterijuDatum").hide();
                $("#PrikazPretrPoDatMust").hide();
                $("#PrikaziSortiraneVoznjeMust").hide();
                $("#map").hide();



                $.get("/api/Voznja", function (data, status) {
                    let id = localStorage.getItem("voznjaOtkaz");
                    let tableofData3 = "<table border='1'>";
                    for (voznja in data) {
                        if (data[voznja].IdVoznje == id) {
                            tableofData3 += "<tr><td>Opis</td><td><input id=\"opis\" type=\"text\" name=\"Opis\" value=\"" + data[voznja].Komentar.Opis + "\"/></td></tr>";

                        }
                    }
                    tableofData3 += "</table>";
                    $("#IzmjenaShow4").html(tableofData3);
                });
            });






            $("#potvrdiIzmjenu").click(function () {

                let korisnik = {
                    Id: dataP.Id,
                    KorisnickoIme: `${$('#korImeReg').val()}`,
                    Lozinka: `${$('#korPassReg').val()}`,
                    Ime: `${$('#ime').val()}`,
                    Prezime: `${$('#prezime').val()}`,
                    Pol: dataP.Pol,
                    JMBG: ` ${$('#jmbg').val()}`,
                    Email: `${$('#email').val()}`,
                    KontaktTelefon: `${$('#brTelefona').val()}`,
                    Uloga: dataP.Uloga,
                };

                $.ajax({
                    type: 'PUT',
                    url: '/api/Musterija/' + dataP.Id,
                    data: JSON.stringify(korisnik),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert('Uspjesno izmjenjena musterija');
                            localStorage.setItem("logovan", korisnik.KorisnickoIme);
                            $(location).attr('href', 'Korisnik.html');
                        } else {
                            alert('Ne postoji musterija koju zelite da mijenjate');
                        }
                    },
                })
            });


            $("#potvrdiIzmjenu1").click(function () {

                let korisnik = {
                    Id: dataP.Id,
                    KorisnickoIme: `${$('#korImeReg').val()}`,
                    Lozinka: `${$('#korPassReg').val()}`,
                    Ime: `${$('#ime').val()}`,
                    Prezime: `${$('#prezime').val()}`,
                    Pol: dataP.Pol,
                    JMBG: ` ${$('#jmbg').val()}`,
                    Email: `${$('#email').val()}`,
                    KontaktTelefon: `${$('#brTelefona').val()}`,
                    Uloga: dataP.Uloga,
                };

                $.ajax({
                    type: 'PUT',
                    url: '/api/Dispecer/' + dataP.Id,
                    data: JSON.stringify(korisnik),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert('Uspjesno izmjenjen dispecer');
                            localStorage.setItem("logovan", korisnik.KorisnickoIme);
                            $(location).attr('href', 'Korisnik.html');
                        } else {
                            alert('Ne postoji dispecer kojeg zelite da mijenjate');
                        }
                    },
                })
            });



            $("#potvrdiIzmjenu2").click(function () {

                let adresa = {
                    IdAdr: `${$('#idadrese2').val()}`,
                    UlicaIBroj: `${$('#ulicaibroj2').val()}`,
                    NaseljenoMjesto: `${$('#naseljenomjesto2').val()}`,
                    PozivniBroj: `${$('#pozivnibroj2').val()}`,
                };

                let lokacija = {
                    IdLok: `${$('#idlokacije2').val()}`,
                    X: `${$('#x2').val()}`,
                    Y: `${$('#y2').val()}`,
                    Adresa: adresa,
                };


                let automobil = {
                    IdVozaca: dataP.Id,
                    Godiste: `${$('#godiste2').val()}`,
                    Registracija: `${$('#registracija2').val()}`,
                    BrojVozila: `${$('#brojvozila2').val()}`,
                    TipAuta: dataP.Automobil.TipAuta,
                };

                let korisnik = {
                    Id: dataP.Id,
                    KorisnickoIme: `${$('#korImeReg2').val()}`,
                    Lozinka: `${$('#korPassReg2').val()}`,
                    Ime: `${$('#ime2').val()}`,
                    Prezime: `${$('#prezime2').val()}`,
                    Pol: `${$('#pol2').val()}`,
                    JMBG: ` ${$('#jmbg2').val()}`,
                    Email: `${$('#email2').val()}`,
                    KontaktTelefon: `${$('#brTelefona2').val()}`,
                    Uloga: dataP.Uloga,
                    Lokacija: lokacija,
                    Automobil: automobil,
                };


                $.ajax({
                    type: 'PUT',
                    url: '/api/Vozac/' + automobil.IdVozaca,
                    data: JSON.stringify(korisnik),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert('Uspjesno izmjenjen vozac');
                            localStorage.setItem("logovan", korisnik.KorisnickoIme);
                            $(location).attr('href', 'Korisnik.html');
                        } else {
                            alert('Ne postoji vozac kojeg zelite da mijenjate');
                        }
                    },
                })

            });



            $("#potvrdiIzmjenuVoznja").click(function () {
                let id1 = localStorage.getItem("voznjaIzmjena");
                let dijelovi = fulAdresa.split(",");
                let x = dijelovi[0];
                let y = dijelovi[1];
                let ulicaIbroj = dijelovi[2];
                let grad = dijelovi[3]; //sa zipom

                let adresaDolazak = {
                    IdAdr: "",
                    UlicaIBroj: ulicaIbroj,
                    NaseljenoMjesto: grad,
                    PozivniBroj: "",
                };

                let lokacijaDolazak = {
                    IdLok: "",
                    X: x,
                    Y: y,
                    Adresa: adresaDolazak,
                };


                let voznja = {
                    Dolazak: lokacijaDolazak,
                    MusterijaVoznja: dataP.KorisnickoIme,
                    VozacVoznja: null,
                    Iznos: 0,
                    DispecerVoznja: null,
                    StatusVoznje: "Kreirana",
                };


                $.ajax({
                    type: 'PUT',
                    url: '/api/Voznja/' + id1,
                    data: JSON.stringify(voznja),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert('Uspjesno izmjenjena voznja');
                            localStorage.setItem("voznjaIzmjena", id1);
                            $(location).attr('href', 'Korisnik.html');
                        } else {
                            alert('Ne postoji voznja koju zelite da mijenjate');
                        }
                    },
                })

            });






            $("#potvrdiKomentar").click(function () {                       //za musteriju
                let dt = new Date();
                let id2 = localStorage.getItem("voznjaOtkaz");
                let komentarVoznja = {
                    Opis: `${$('#opis').val()}`,
                    DTObjave: dt.toLocaleString(), //d.toLocaleString()
                    Ocjena: 0,
                    KorImeKorisnikKomentar: dataP.KorisnickoIme,
                    IdVoznjaKomentar: id2,
                };

                let voznja = {
                    MusterijaVoznja: dataP.KorisnickoIme,
                    VozacVoznja: null,
                    Iznos: 0,
                    DispecerVoznja: null,
                    Komentar: komentarVoznja,
                    StatusVoznje: "Otkazana",
                };

                $.ajax({
                    type: 'PUT',
                    url: '/api/Voznja/' + id2,
                    data: JSON.stringify(voznja),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert('Uspjesno otkazana voznja');
                            localStorage.setItem("voznjaOtkaz", id2);
                            $(location).attr('href', 'Korisnik.html');
                        } else {
                            alert('Ne postoji voznja koju zelite da otkazete ili nije u odgovarajucem stanju');
                        }
                    },
                })

            });





            $("#dodajVozaca").click(function () {
                $("#DodavanjeVozaca").show();
                $("#IzmjenaKorisnik1").hide();
                $("#PrikazKorisnik1").hide();
                $("#PrikaziVoznjeDispecer").hide();
                $("#PrikaziVoznjeDispecerSve").hide();
                $("#PrikazMusterijaZaBan").hide();
                $("#PrikaziFiltriraneVoznjeDisp").hide();
                $("#PrikazVozacaZaBan").hide();
                $("#PrikaziFiltriraneVoznjeSveDisp").hide();
                $("#map").show();

            });

            $("#dodaj").click(function () {
                $("#DodavanjeVozaca").show();
                $("#IzmjenaKorisnik1").hide();
                $("#PrikazKorisnik1").hide();
                $("#map").show();
                let dijelovi = fulAdresa.split(",");
                let x = dijelovi[0];
                let y = dijelovi[1];
                let ulicaIbroj = dijelovi[2];
                let grad = dijelovi[3]; //sa zipom

                let adresa = {
                    IdAdr: "",
                    UlicaIBroj: ulicaIbroj,
                    NaseljenoMjesto: grad,
                    PozivniBroj: "",
                };

                let lokacija = {
                    IdLok: "",
                    X: x,
                    Y: y,
                    Adresa: adresa,
                };


                let automobil = {
                    Godiste: `${$('#godiste').val()}`,
                    Registracija: `${$('#registracija').val()}`,
                    BrojVozila: `${$('#brojvozila').val()}`,
                    TipAuta: `${$('#tipauta').val()}`,
                };

                let vozac = {
                    KorisnickoIme: `${$('#korImeReg1').val()}`,
                    Lozinka: `${$('#korPassReg1').val()}`,
                    Ime: `${$('#ime1').val()}`,
                    Prezime: `${$('#prezime1').val()}`,
                    Pol: `${$('#pol1').val()}`,
                    JMBG: ` ${$('#jmbg1').val()}`,
                    Email: `${$('#email1').val()}`,
                    KontaktTelefon: `${$('#brTelefona1').val()}`,
                    Lokacija: lokacija,
                    Automobil: automobil,
                };


                $.ajax({
                    type: 'POST',
                    url: '/api/Vozac',
                    data: JSON.stringify(vozac),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert('Uspjesno registovan vozac');             //////////////// jel treba localstorage
                            $(location).attr('href', 'Korisnik.html');
                        } else {
                            alert('Vec je registrovan korisnik s tim korisnickim imenom.');
                        }
                    },
                })
            });


            $("#dodajVoznju").click(function () {    // za musteriju
                $("#PrikaziVoznjeMusterije").hide();
                $("#DodavanjeVoznjeMusterija").show();
                $("#DodavanjeVozaca").hide();
                $("#IzmjenaKorisnik").hide();
                $("#PrikazKorisnik").hide();
                $("#IzmjenaVoznja").hide();
                $("#PrikaziSortiraneVoznjeMust").hide();
                $("#KomentarVoznja").hide();
                $("#PrikaziFiltriraneVoznjeMust").hide();
                $("#PrikazPretrPoDatMust").hide();
                $("#map").show();

            });

            $("#dodajVoznjuMusterija").click(function () {
                $("#PrikaziVoznjeMusterije").hide();
                $("#DodavanjeVoznjeMusterija").show();
                $("#DodavanjeVozaca").hide();
                $("#IzmjenaKorisnik").hide();
                $("#PrikazKorisnik").hide();
                $("#PrikaziFiltriraneVoznjeMust").hide();
                $("#PrikazPretrPoDatMust").hide();
                $("#map").show();

                let dijelovi = fulAdresa.split(",");
                let x = dijelovi[0];
                let y = dijelovi[1];
                let ulicaIbroj = dijelovi[2];
                let grad = dijelovi[3]; //sa zipom


                let adresaDolazak = {
                    IdAdr: "",
                    UlicaIBroj: ulicaIbroj,
                    NaseljenoMjesto: grad,
                    PozivniBroj: "",
                };

                let lokacijaDolazak = {
                    IdLok: "",
                    X: x,
                    Y: y,
                    Adresa: adresaDolazak,
                };


                let voznja = {
                    Dolazak: lokacijaDolazak,
                    TipAutaVoznje: `${$('#tipau').val()}`,
                    MusterijaVoznja: dataP.KorisnickoIme,
                    VozacVoznja: null,
                    Iznos: 0,
                    DispecerVoznja: null,
                };


                $.ajax({
                    type: 'POST',
                    url: '/api/Voznja',
                    data: JSON.stringify(voznja),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert('Uspjesno unesena voznja');             //////////////// jel treba localstorage
                            $(location).attr('href', 'Korisnik.html');
                        } else {
                            alert('Vec je drugi taxista na toj lokaciji.');
                        }
                    },
                })
            });


            $("#dodajVoznjuDisp").click(function () {    // za dispecera
                $("#PrikaziVoznjeMusterije").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#PrikaziVoznjeDispecerSve").hide();
                $("#DodavanjeVozaca").hide();
                $("#IzmjenaKorisnik1").hide();
                $("#PrikazKorisnik1").hide();
                $("#PrikazVozacaZaBan").hide();
                $("#PrikaziFiltriraneVoznjeDisp").hide();
                $("#PrikaziFiltriraneVoznjeSveDisp").hide();
                $("#IzmjenaVoznja").hide();
                $("#KomentarVoznja").hide();
                $("#DodavanjeVoznjeDispecer").show();
                $("#PrikaziVoznjeDispecer").hide();
                $("#map").show();

            });



            $("#dodajVoznjuDispecer").click(function () {    // za dispecera
                $("#map").show();
                $.get("/api/Vozac", function (data, status) {
                    let pom = `${$('#tipauDisp').val()}`
                    let pom1;
                    let koliko1 = 0;
                    if (pom == "Kombi") {
                        pom1 = 1;
                    } else {
                        pom1 = 0;
                    }
                    let table = "<table border='1'><tr><td><select id=\"vozac\" name=\"VozacVoznja\"> ";

                    for (driver in data) {
                        if (data[driver].Automobil.TipAuta == pom1 && data[driver].Zauzet == false) {
                            table += "<option>" + data[driver].KorisnickoIme + "</option>";
                            koliko1++;
                        }
                    }
                    table += "</select></td></tr></table><button id=\"dodajVoznjuDispecer2\" type=\"button\"><b>Dodaj voznju</b></button>";
                    if (koliko1 == 0) {
                        alert('Trenutno nema slobodnih vozača sa traženim automobilom.');
                        $(location).attr('href', 'Korisnik.html');
                    } else {
                        $("#DodavanjeVoznjeDispecer").append(table);
                    }

                });

            });


            $(document).on('click', '#dodajVoznjuDispecer2', function () {

                $("#PrikaziVoznjeMusterije").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#DodavanjeVozaca").hide();
                $("#IzmjenaKorisnik").hide();
                $("#PrikazVozacaZaBan").hide();
                $("#PrikazKorisnik").hide();
                $("#DodavanjeVoznjeDispecer").show();
                $("#map").show();

                let dijelovi = fulAdresa.split(",");
                let x = dijelovi[0];
                let y = dijelovi[1];
                let ulicaIbroj = dijelovi[2];
                let grad = dijelovi[3]; //sa zipom

                let adresaDolazak = {
                    IdAdr: "",
                    UlicaIBroj: ulicaIbroj,
                    NaseljenoMjesto: grad,
                    PozivniBroj: "",
                };

                let lokacijaDolazak = {
                    IdLok: "",
                    X: x,
                    Y: y,
                    Adresa: adresaDolazak,
                };




                let voznja = {
                    Dolazak: lokacijaDolazak,
                    TipAutaVoznje: `${$('#tipauDisp').val()}`,
                    MusterijaVoznja: null,
                    VozacVoznja: `${$('#vozac').val()}`,
                    Iznos: 0,
                    DispecerVoznja: dataP.KorisnickoIme,
                };


                $.ajax({
                    type: 'POST',
                    url: '/api/Voznja',
                    data: JSON.stringify(voznja),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert('Uspjesno unesena voznja');             //////////////// jel treba localstorage
                            $(location).attr('href', 'Korisnik.html');
                        } else {
                            alert('Vec je drugi taxista na toj lokaciji.');
                        }
                    },
                })
            });





            $("#prikaziVoznjeMust").click(function () {
                $("#PrikaziVoznjeMusterije").show();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#PrikaziFiltriraneVoznjeMust").hide();
                $("#IzmjenaKorisnik").hide();
                $("#PretraziMusterijuDatum").hide();
                $("#PrikaziSortiraneVoznjeMust").hide();
                $("#PrikazKorisnik").hide();
                $("#PrikazPretrPoDatMust").hide();


                $.get("/api/Voznja", function (data, status) {
                    let tableOfProducts = "<table border='1'>";
                    tableOfProducts += `<tr><th>Mušterija vožnje</th><th>Dat. porudž.</th><th>Ulica i br. dolaska</th><th>Mjesto dol.</th><th>Status vož.</th><th>Opis kom.</th><th>Ocena kom.</th><th>Dat. obj. kom. vož.</th><th> </th><th> </th></tr>`;
                    for (voznja in data) {
                        if (dataP.KorisnickoIme == data[voznja].MusterijaVoznja) {
                            tableOfProducts += `<tr><td>${data[voznja].MusterijaVoznja}</td><td>${data[voznja].DTPorudzbine}</td><td>${data[voznja].Dolazak.Adresa.UlicaIBroj}</td><td>${data[voznja].Dolazak.Adresa.NaseljenoMjesto}</td>`;
                            if (data[voznja].StatusVoznje == 0) {
                                tableOfProducts += '<td>Kreirana</td>';
                            } else if (data[voznja].StatusVoznje == 1) {
                                tableOfProducts += '<td>Formirana</td>';
                            } else if (data[voznja].StatusVoznje == 2) {
                                tableOfProducts += '<td>Obradjena</td>';
                            } else if (data[voznja].StatusVoznje == 3) {
                                tableOfProducts += '<td>Prihvacena</td>';
                            } else if (data[voznja].StatusVoznje == 4) {
                                tableOfProducts += '<td>Otkazana</td>';
                            } else if (data[voznja].StatusVoznje == 5) {
                                tableOfProducts += '<td>Neuspjesna</td>';
                            } else if (data[voznja].StatusVoznje == 6) {
                                tableOfProducts += '<td>Uspjesna</td>';
                            } else {
                                tableOfProducts += '<td>Utoku</td>';
                            }

                            if (data[voznja].StatusVoznje == 0) {
                                tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="otkaziVoznja" type="button" value=${data[voznja].IdVoznje}><b>Otkazi voznju</b></button></td><td><button id="izmjeniVoznja" type="button" value=${data[voznja].IdVoznje}><b>Izmjeni voznju</b></button></td></tr>`;
                            } else if (data[voznja].StatusVoznje == 6) {
                                tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="komentarisi" type="button" value=${data[voznja].IdVoznje}><b>Komentarisi voznju</b></button></td><td><button id="izmjeniVoznja" type="button" value ="disable" disabled="disabled"><b>Izmjeni voznju</b></button></td></tr>`;
                            } else {
                                tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="otkaziVoznja" type="button" value ="disable" disabled="disabled"><b>Otkazi voznju</b></button></td><td><button id="izmjeniVoznja" type="button" value ="disable" disabled="disabled"><b>Izmjeni voznju</b></button></td></tr>`;
                            }
                        }
                    }
                    tableOfProducts += `<tr><td><select id="filterStatusMustCombo" name="StatusVoznje"><option>Kreirana</option><option>Formirana</option><option>Obradjena</option><option>Prihvacena</option><option>Otkazana</option><option>Neuspjesna</option><option>Uspjesna</option><option>Utoku</option></select></td></tr></table><button id="filterStatusMustButton" type="button"><b>Filtriraj</b></button><button id="sortiranjeOcjenaMust" type="button"><b>Sortiraj po ocjeni</b></button><button id="sortiranjeDatumMust" type="button"><b>Sortiraj po datumu</b></button><button id="pretragaDatumMust" type="button"><b>Pretrazi po datumu</b></button>`;
                    $("#PrikaziVoznjeMusterije").html(tableOfProducts);
                });
            });


            $(document).on('click', '#filterStatusMustButton', function () {
                $("#PrikaziFiltriraneVoznjeMust").show();
                $("#PrikaziVoznjeMusterije").hide();
                $("#PrikaziSortiraneVoznjeMust").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#PretraziMusterijuDatum").hide();
                $("#PrikazPretrPoDatMust").hide();
                $("#IzmjenaKorisnik").hide();
                $("#PrikazKorisnik").hide();
                $.get("/api/Voznja", function (data, status) {
                    let pom = `${$('#filterStatusMustCombo').val()}`
                    let pom1;
                    if (pom == "Kreirana") {
                        pom1 = 0;
                    } else if (pom == "Formirana") {
                        pom1 = 1;
                    } else if (pom == "Obradjena") {
                        pom1 = 2;
                    } else if (pom == "Prihvacena") {
                        pom1 = 3;
                    } else if (pom == "Otkazana") {
                        pom1 = 4;
                    } else if (pom == "Neuspjesna") {
                        pom1 = 5;
                    } else if (pom == "Uspjesna") {
                        pom1 = 6;
                    } else {
                        pom1 = 7;
                    }
                    let tableOfProducts = "<table border='1'>";
                    tableOfProducts += `<tr><th>Mušterija vožnje</th><th>Dat. porudž.</th><th>Ulica i br. dolaska</th><th>Mjesto dol.</th><th>Pozivni br. dol.</th><th>Status vož.</th><th>Opis kom.</th><th>Ocjena kom.</th><th>Dat. obj. kom. vož.</th><th> </th><th> </th></tr>`;
                    for (voznja in data) {
                        if (dataP.KorisnickoIme == data[voznja].MusterijaVoznja && pom1 == data[voznja].StatusVoznje) {
                            tableOfProducts += `<tr><td>${data[voznja].MusterijaVoznja}</td><td>${data[voznja].DTPorudzbine}</td><td>${data[voznja].Dolazak.Adresa.UlicaIBroj}</td><td>${data[voznja].Dolazak.Adresa.NaseljenoMjesto}</td><td>${data[voznja].Dolazak.Adresa.PozivniBroj}</td>`;
                            if (data[voznja].StatusVoznje == 0) {
                                tableOfProducts += '<td>Kreirana</td>';
                            } else if (data[voznja].StatusVoznje == 1) {
                                tableOfProducts += '<td>Formirana</td>';
                            } else if (data[voznja].StatusVoznje == 2) {
                                tableOfProducts += '<td>Obradjena</td>';
                            } else if (data[voznja].StatusVoznje == 3) {
                                tableOfProducts += '<td>Prihvacena</td>';
                            } else if (data[voznja].StatusVoznje == 4) {
                                tableOfProducts += '<td>Otkazana</td>';
                            } else if (data[voznja].StatusVoznje == 5) {
                                tableOfProducts += '<td>Neuspjesna</td>';
                            } else if (data[voznja].StatusVoznje == 6) {
                                tableOfProducts += '<td>Uspjesna</td>';
                            } else {
                                tableOfProducts += '<td>Utoku</td>';
                            }

                            if (data[voznja].StatusVoznje == 0) {
                                tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="otkaziVoznja" type="button" value=${data[voznja].IdVoznje}><b>Otkazi voznju</b></button></td><td><button id="izmjeniVoznja" type="button" value=${data[voznja].IdVoznje}><b>Izmjeni voznju</b></button></td></tr>`;
                            } else if (data[voznja].StatusVoznje == 6) {
                                tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="komentarisi" type="button" value=${data[voznja].IdVoznje}><b>Komentarisi voznju</b></button></td><td><button id="izmjeniVoznja" type="button" value ="disable" disabled="disabled"><b>Izmjeni voznju</b></button></td></tr>`;
                            } else {
                                tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="otkaziVoznja" type="button" value ="disable" disabled="disabled"><b>Otkazi voznju</b></button></td><td><button id="izmjeniVoznja" type="button" value ="disable" disabled="disabled"><b>Izmjeni voznju</b></button></td></tr>`;
                            }
                        }
                    }
                    tableOfProducts += `<tr><td><select id="filterStatusMustCombo" name="StatusVoznje"><option value="Kreirana">Kreirana</option><option value="Formirana">Formirana</option><option value="Obradjena">Obradjena</option><option value="Prihvacena">Prihvacena</option><option value="Otkazana">Otkazana</option><option value="Neuspjesna">Neuspjesna</option><option value="Uspjesna">Uspjesna</option><option value="Utoku">Utoku</option></select></td></tr></table><button id="filterStatusMustButton" type="button"><b>Filtriraj</b></button><button id="vratiSeMust" type="button"><b>Izadji iz rezima filtriranja</b></button>`;
                    $("#PrikaziFiltriraneVoznjeMust").html(tableOfProducts);
                });
            });

            $(document).on('click', '#vratiSeMust', function () {
                $(location).attr('href', 'Korisnik.html');
            });




            $(document).on('click', '#sortiranjeOcjenaMust', function () {  //za sortiranje
                $("#PrikaziFiltriraneVoznjeMust").hide();
                $("#PrikaziSortiraneVoznjeMust").show();
                $("#PrikaziSortiraneVoznjeDatumMust").hide();
                $("#PrikaziVoznjeMusterije").hide();
                $("#PretraziMusterijuDatum").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#PrikazPretrPoDatMust").hide();
                $("#IzmjenaKorisnik").hide();
                $("#PrikazKorisnik").hide();
                $.get("/api/Voznja", function (data, status) {
                    let ocene = [];
                    for (voznja in data) {
                        if (dataP.KorisnickoIme == data[voznja].MusterijaVoznja) {
                            ocene.push(data[voznja].Komentar.Ocjena)
                        }
                    }
                    ocene.sort(function (a, b) {
                        return b - a;
                    });

                    let tableOfProducts = "<table border='1'>";
                    tableOfProducts += `<tr><th>Mušterija vožnje</th><th>Dat. porudž.</th><th>Ulica i br. dolaska</th><th>Mjesto dol.</th><th>Pozivni br. dol.</th><th>Status vož.</th><th>Opis kom.</th><th>Ocjena kom.</th><th>Dat. obj. kom. vož.</th><th> </th><th> </th></tr>`;
                    for (o in ocene) {
                        for (voznja in data) {
                            if (dataP.KorisnickoIme == data[voznja].MusterijaVoznja) {
                                if (ocene[o] == data[voznja].Komentar.Ocjena) {
                                    tableOfProducts += `<tr><td>${data[voznja].MusterijaVoznja}</td><td>${data[voznja].DTPorudzbine}</td><td>${data[voznja].Dolazak.Adresa.UlicaIBroj}</td><td>${data[voznja].Dolazak.Adresa.NaseljenoMjesto}</td><td>${data[voznja].Dolazak.Adresa.PozivniBroj}</td>`;
                                    if (data[voznja].StatusVoznje == 0) {
                                        tableOfProducts += '<td>Kreirana</td>';
                                    } else if (data[voznja].StatusVoznje == 1) {
                                        tableOfProducts += '<td>Formirana</td>';
                                    } else if (data[voznja].StatusVoznje == 2) {
                                        tableOfProducts += '<td>Obradjena</td>';
                                    } else if (data[voznja].StatusVoznje == 3) {
                                        tableOfProducts += '<td>Prihvacena</td>';
                                    } else if (data[voznja].StatusVoznje == 4) {
                                        tableOfProducts += '<td>Otkazana</td>';
                                    } else if (data[voznja].StatusVoznje == 5) {
                                        tableOfProducts += '<td>Neuspjesna</td>';
                                    } else if (data[voznja].StatusVoznje == 6) {
                                        tableOfProducts += '<td>Uspjesna</td>';
                                    } else {
                                        tableOfProducts += '<td>Utoku</td>';
                                    }

                                    if (data[voznja].StatusVoznje == 0) {
                                        tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="otkaziVoznja" type="button" value=${data[voznja].IdVoznje}><b>Otkazi voznju</b></button></td><td><button id="izmjeniVoznja" type="button" value=${data[voznja].IdVoznje}><b>Izmjeni voznju</b></button></td></tr>`;
                                    } else if (data[voznja].StatusVoznje == 6) {
                                        tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="komentarisi" type="button" value=${data[voznja].IdVoznje}><b>Komentarisi voznju</b></button></td><td><button id="izmjeniVoznja" type="button" value ="disable" disabled="disabled"><b>Izmjeni voznju</b></button></td></tr>`;
                                    } else {
                                        tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="otkaziVoznja" type="button" value ="disable" disabled="disabled"><b>Otkazi voznju</b></button></td><td><button id="izmjeniVoznja" type="button" value ="disable" disabled="disabled"><b>Izmjeni voznju</b></button></td></tr>`;
                                    }
                                }

                            }
                        }
                    }
                    tableOfProducts += `<tr><td><select id="filterStatusMustCombo" name="StatusVoznje"><option value="Kreirana">Kreirana</option><option value="Formirana">Formirana</option><option value="Obradjena">Obradjena</option><option value="Prihvacena">Prihvacena</option><option value="Otkazana">Otkazana</option><option value="Neuspjesna">Neuspjesna</option><option value="Uspjesna">Uspjesna</option></select></td></tr></table><button id="filterStatusMustButton" type="button"><b>Filtriraj</b></button>`;
                    $("#PrikaziSortiraneVoznjeMust").html(tableOfProducts);
                });
            });



            $(document).on('click', '#sortiranjeDatumMust', function () {  //za sortiranje datuma
                $("#PrikaziFiltriraneVoznjeMust").hide();
                $("#PrikaziSortiraneVoznjeMust").hide();
                $("#PrikaziSortiraneVoznjeDatumMust").show();
                $("#PrikaziVoznjeMusterije").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#IzmjenaKorisnik").hide();
                $("#PrikazPretrPoDatMust").hide();
                $("#PretraziMusterijuDatum").hide();
                $("#PrikazKorisnik").hide();
                $.get("/api/Voznja", function (data, status) {
                    let datumi = [];
                    for (voznja in data) {
                        if (dataP.KorisnickoIme == data[voznja].MusterijaVoznja) {
                            datumi.push(data[voznja].DTPorudzbine)
                        }
                    }

                    let date_sort_desc = function (date1, date2) {
                        if (date1 > date2) return -1;
                        if (date1 < date2) return 1;
                        return 0;
                    };

                    datumi.sort(date_sort_desc);

                    let tableOfProducts = "<table border='1'>";
                    tableOfProducts += `<tr><th>Mušterija vožnje</th><th>Dat. porudž.</th><th>Ulica i br. dolaska</th><th>Mjesto dol.</th><th>Pozivni br. dol.</th><th>Status vož.</th><th>Opis kom.</th><th>Ocjena kom.</th><th>Dat. obj. kom. vož.</th><th> </th><th> </th></tr>`;
                    for (d in datumi) {
                        for (voznja in data) {
                            if (dataP.KorisnickoIme == data[voznja].MusterijaVoznja) {
                                if (datumi[d] == data[voznja].DTPorudzbine) {
                                    tableOfProducts += `<tr><td>${data[voznja].MusterijaVoznja}</td><td>${data[voznja].DTPorudzbine}</td><td>${data[voznja].Dolazak.Adresa.UlicaIBroj}</td><td>${data[voznja].Dolazak.Adresa.NaseljenoMjesto}</td><td>${data[voznja].Dolazak.Adresa.PozivniBroj}</td>`;
                                    if (data[voznja].StatusVoznje == 0) {
                                        tableOfProducts += '<td>Kreirana</td>';
                                    } else if (data[voznja].StatusVoznje == 1) {
                                        tableOfProducts += '<td>Formirana</td>';
                                    } else if (data[voznja].StatusVoznje == 2) {
                                        tableOfProducts += '<td>Obradjena</td>';
                                    } else if (data[voznja].StatusVoznje == 3) {
                                        tableOfProducts += '<td>Prihvacena</td>';
                                    } else if (data[voznja].StatusVoznje == 4) {
                                        tableOfProducts += '<td>Otkazana</td>';
                                    } else if (data[voznja].StatusVoznje == 5) {
                                        tableOfProducts += '<td>Neuspjesna</td>';
                                    } else if (data[voznja].StatusVoznje == 6) {
                                        tableOfProducts += '<td>Uspjesna</td>';
                                    } else {
                                        tableOfProducts += '<td>Utoku</td>';
                                    }

                                    if (data[voznja].StatusVoznje == 0) {
                                        tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="otkaziVoznja" type="button" value=${data[voznja].IdVoznje}><b>Otkazi voznju</b></button></td><td><button id="izmjeniVoznja" type="button" value=${data[voznja].IdVoznje}><b>Izmjeni voznju</b></button></td></tr>`;
                                    } else if (data[voznja].StatusVoznje == 6) {
                                        tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="komentarisi" type="button" value=${data[voznja].IdVoznje}><b>Komentarisi voznju</b></button></td><td><button id="izmjeniVoznja" type="button" value ="disable" disabled="disabled"><b>Izmjeni voznju</b></button></td></tr>`;
                                    } else {
                                        tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="otkaziVoznja" type="button" value ="disable" disabled="disabled"><b>Otkazi voznju</b></button></td><td><button id="izmjeniVoznja" type="button" value ="disable" disabled="disabled"><b>Izmjeni voznju</b></button></td></tr>`;
                                    }
                                }

                            }
                        }
                    }
                    tableOfProducts += `<tr><td><select id="filterStatusMustCombo" name="StatusVoznje"><option value="Kreirana">Kreirana</option><option value="Formirana">Formirana</option><option value="Obradjena">Obradjena</option><option value="Prihvacena">Prihvacena</option><option value="Otkazana">Otkazana</option><option value="Neuspjesna">Neuspjesna</option><option value="Uspjesna">Uspjesna</option></select></td></tr></table><button id="filterStatusMustButton" type="button"><b>Filtriraj</b></button>`;
                    $("#PrikaziSortiraneVoznjeDatumMust").html(tableOfProducts);
                });
            });



            $(document).on('click', '#pretragaDatumMust', function () {  // za pretragu musterije
                $("#PrikaziVoznjeMusterije").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#PrikaziVoznjeDispecerSve").hide();
                $("#DodavanjeVozaca").hide();
                $("#IzmjenaKorisnik1").hide();
                $("#PrikazKorisnik1").hide();
                $("#PrikaziFiltriraneVoznjeDisp").hide();
                $("#PrikaziFiltriraneVoznjeSveDisp").hide();
                $("#IzmjenaVoznja").hide();
                $("#KomentarVoznja").hide();
                $("#DodavanjeVoznjeDispecer").hide();
                $("#PrikaziVoznjeDispecer").hide();
                $("#PrikazPretrPoDatMust").hide();
                $("#PretraziMusterijuDatum").show();

            });



            $("#pretragaStartMust").click(function () {    // za pretragu musterije
                $.get("/api/Vozac", function (data, status) {
                    let pom = `${$('#pretragaMust').val()}`;
                    let tableofData3;
                    if (pom == "Po datumu") {
                        tableofData3 = `<table border='1'><tr><td>Od:</td><td><input id="datumOd" type="date" name="DTPorudzbine"/></td></tr><tr><td>Do:</td><td><input id="datumDo" type="date" name="DTPorudzbine"/></td></tr></table><button id="pretragaPrikazDatumMust" type="button"><b>Prikazi</b></button>`;
                    } else if (pom == "Po ocjeni") {

                    } else {

                    }
                    $("#PretraziMusterijuDatum").html(tableofData3);

                });

            });

            $(document).on('click', '#pretragaPrikazDatumMust', function () {
                $("#PrikazPretrPoDatMust").show();
                $("#PrikaziFiltriraneVoznjeMust").hide();
                $("#PrikaziVoznjeMusterije").hide();
                $("#PretraziMusterijuDatum").hide();
                $("#PrikaziSortiraneVoznjeMust").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#IzmjenaKorisnik").hide();
                $("#PrikazKorisnik").hide();
                $.get("/api/Voznja", function (data, status) {
                    let pomOd = `${$('#datumOd').val()}`;
                    let pomDo = `${$('#datumDo').val()}`;
                    let date_test;
                    let date;

                    let tableOfProducts = "<table border='1'>";
                    tableOfProducts += `<tr><th>Mušterija vožnje</th><th>Dat. porudž.</th><th>Ulica i br. dolaska</th><th>Mjesto dol.</th><th>Pozivni br. dol.</th><th>Status vož.</th><th>Opis kom.</th><th>Ocjena kom.</th><th>Dat. obj. kom. vož.</th><th> </th><th> </th></tr>`;
                    for (voznja in data) {
                        if (dataP.KorisnickoIme == data[voznja].MusterijaVoznja) {
                            if (pomOd != null && pomDo != null) {
                                date = new Date(data[voznja].DTPorudzbine);  //DODATI IF
                                date_test = date.getFullYear() + '-0' + (date.getMonth() + 1) + '-' + date.getDate();
                                if (pomOd <= date_test && date_test <= pomDo) {
                                    tableOfProducts += `<tr><td>${data[voznja].MusterijaVoznja}</td><td>${data[voznja].DTPorudzbine}</td><td>${data[voznja].Dolazak.Adresa.UlicaIBroj}</td><td>${data[voznja].Dolazak.Adresa.NaseljenoMjesto}</td><td>${data[voznja].Dolazak.Adresa.PozivniBroj}</td>`;
                                    if (data[voznja].StatusVoznje == 0) {
                                        tableOfProducts += '<td>Kreirana</td>';
                                    } else if (data[voznja].StatusVoznje == 1) {
                                        tableOfProducts += '<td>Formirana</td>';
                                    } else if (data[voznja].StatusVoznje == 2) {
                                        tableOfProducts += '<td>Obradjena</td>';
                                    } else if (data[voznja].StatusVoznje == 3) {
                                        tableOfProducts += '<td>Prihvacena</td>';
                                    } else if (data[voznja].StatusVoznje == 4) {
                                        tableOfProducts += '<td>Otkazana</td>';
                                    } else if (data[voznja].StatusVoznje == 5) {
                                        tableOfProducts += '<td>Neuspjesna</td>';
                                    } else if (data[voznja].StatusVoznje == 6) {
                                        tableOfProducts += '<td>Uspjesna</td>';
                                    } else {
                                        tableOfProducts += '<td>Utoku</td>';
                                    }

                                    if (data[voznja].StatusVoznje == 0) {
                                        tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="otkaziVoznja" type="button" value=${data[voznja].IdVoznje}><b>Otkazi voznju</b></button></td><td><button id="izmjeniVoznja" type="button" value=${data[voznja].IdVoznje}><b>Izmjeni voznju</b></button></td></tr>`;
                                    } else if (data[voznja].StatusVoznje == 6) {
                                        tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="komentarisi" type="button" value=${data[voznja].IdVoznje}><b>Komentarisi voznju</b></button></td><td><button id="izmjeniVoznja" type="button" value ="disable" disabled="disabled"><b>Izmjeni voznju</b></button></td></tr>`;
                                    } else {
                                        tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="otkaziVoznja" type="button" value ="disable" disabled="disabled"><b>Otkazi voznju</b></button></td><td><button id="izmjeniVoznja" type="button" value ="disable" disabled="disabled"><b>Izmjeni voznju</b></button></td></tr>`;
                                    }
                                }
                            }
                        }
                    }
                    tableOfProducts += `<tr><td><select id="filterStatusMustCombo" name="StatusVoznje"><option value="Kreirana">Kreirana</option><option value="Formirana">Formirana</option><option value="Obradjena">Obradjena</option><option value="Prihvacena">Prihvacena</option><option value="Otkazana">Otkazana</option><option value="Neuspjesna">Neuspjesna</option><option value="Uspjesna">Uspjesna</option><option value="Utoku">Utoku</option></select></td></tr></table><button id="filterStatusMustButton" type="button"><b>Filtriraj</b></button><button id="vratiSeMust" type="button"><b>Izadji iz rezima filtriranja</b></button>`;
                    $("#PrikazPretrPoDatMust").html(tableOfProducts);
                });
            });




            $(document).on('click', '#komentarisi', function () {    //komentarisanje uspjesne voznje
                let fired_button11 = $(this).val();
                localStorage.setItem("voznjaComm", fired_button11);
                $("#IzmjenaKorisnik").hide();
                $("#PrikazKorisnik").hide();
                $("#IzmjenaVoznja").hide();
                $("#PrikaziVoznjeMusterije").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#KomentarVoznja").hide();
                $("#Komentarisi").show();


                $.get("/api/Voznja", function (data, status) {
                    let id = localStorage.getItem("voznjaComm");
                    let tableofData11 = "<table border='1'>";
                    for (voznja in data) {
                        if (data[voznja].IdVoznje == id) {
                            tableofData11 += "<tr><td>Opis</td><td><input id=\"opis11\" type=\"text\" name=\"Opis\" value=\"" + data[voznja].Komentar.Opis + "\"/></td></tr>" +
                                "<tr><td>Ocjena</td><td><input id=\"ocjena11\" min=\"0\" max=\"5\" type=\"number\" name=\"Ocjena\" value=\"" + data[voznja].Komentar.Ocjena + "\"/></td></tr>";
                        }
                    }
                    tableofData11 += "</table><button id=\"potvrdiKomentarUspjesne\" type=\"button\"><b>Potvrdi komentar</b></button>";
                    $("#IzmjenaShow11").html(tableofData11);
                });
            });


            $(document).on('click', '#potvrdiKomentarUspjesne', function () {
                let dt = new Date();
                let id11 = localStorage.getItem("voznjaComm");
                let komentarVoznja11 = {
                    Opis: `${$('#opis11').val()}`,
                    DTObjave: dt.toLocaleString(),
                    Ocjena: `${$('#ocjena11').val()}`,
                    KorImeKorisnikKomentar: dataP.KorisnickoIme,
                    IdVoznjaKomentar: id11,
                };

                let voznja = {
                    MusterijaVoznja: dataP.KorisnickoIme,
                    Iznos: 0,
                    Komentar: komentarVoznja11,
                    StatusVoznje: "Uspjesna",
                };

                $.ajax({
                    type: 'PUT',
                    url: '/api/Voznja/' + id11,
                    data: JSON.stringify(voznja),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert('Uspjesno komentarisana voznja');
                            localStorage.setItem("voznjaOtkaz", id11);
                            $(location).attr('href', 'Korisnik.html');
                        } else {
                            alert('Ne postoji voznja koju zelite da komentarisete');
                        }
                    },
                })

            });



            $("#prikaziVoznjeDisp").click(function () {
                $("#PrikaziVoznjeDispecer").show();
                $("#PrikaziVoznjeDispecerSve").hide();
                $("#PrikaziFiltriraneVoznjeDisp").hide();
                $("#PrikazMusterijaZaBan").hide();
                $("#DodavanjeVozaca").hide();
                $("#PrikazVozacaZaBan").hide();
                $("#PrikaziFiltriraneVoznjeSveDisp").hide();
                $("#DodavanjeVoznjeDispecer").hide();
                $("#IzmjenaKorisnik1").hide();
                $("#PrikazKorisnik1").hide();
                $.get("/api/Voznja", function (data, status) {
                    let tableOfProducts = "<table border='1'>";
                    tableOfProducts += `<tr><th>Datum porudžbine</th><th>Ulica i br. dolaska</th><th>Mjesto dol.</th><th>Status vož.</th><th>Komentarisao</th><th>Opis kom.</th><th>Ocjena kom.</th><th>Dat. obj. kom. vož.</th></tr>`;
                    for (voznja in data) {
                        if (dataP.KorisnickoIme == data[voznja].DispecerVoznja) {
                            tableOfProducts += `<tr><td>${data[voznja].DTPorudzbine}</td><td>${data[voznja].Dolazak.Adresa.UlicaIBroj}</td><td>${data[voznja].Dolazak.Adresa.NaseljenoMjesto}</td>`;
                            if (data[voznja].StatusVoznje == 0) {
                                tableOfProducts += '<td>Kreirana</td>';
                            } else if (data[voznja].StatusVoznje == 1) {
                                tableOfProducts += '<td>Formirana</td>';
                            } else if (data[voznja].StatusVoznje == 2) {
                                tableOfProducts += '<td>Obradjena</td>';
                            } else if (data[voznja].StatusVoznje == 3) {
                                tableOfProducts += '<td>Prihvacena</td>';
                            } else if (data[voznja].StatusVoznje == 4) {
                                tableOfProducts += '<td>Otkazana</td>';
                            } else if (data[voznja].StatusVoznje == 5) {
                                tableOfProducts += '<td>Neuspjesna</td>';
                            } else if (data[voznja].StatusVoznje == 6) {
                                tableOfProducts += '<td>Uspjesna</td>';
                            } else {
                                tableOfProducts += '<td>Utoku</td>';
                            }
                            tableOfProducts += `<td>${data[voznja].Komentar.KorImeKorisnikKomentar}</td><td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td></tr>`;
                        }
                    }
                    tableOfProducts += `<tr><td><select id="filterStatusDispCombo" name="StatusVoznje"><option value="Kreirana">Kreirana</option><option value="Formirana">Formirana</option><option value="Obradjena">Obradjena</option><option value="Prihvacena">Prihvacena</option><option value="Otkazana">Otkazana</option><option value="Neuspjesna">Neuspjesna</option><option value="Uspjesna">Uspjesna</option><option value="Utoku">Utoku</option></select></td></tr></table><button id="filterStatusDispButton" type="button"><b>Filtriraj</b></button>`;

                    $("#PrikaziVoznjeDispecer").html(tableOfProducts);

                });
            });




            $(document).on('click', '#filterStatusDispButton', function () {
                $("#PrikaziVoznjeDispecer").hide();
                $("#PrikazMusterijaZaBan").hide();
                $("#PrikaziFiltriraneVoznjeSveDisp").hide();
                $("#PrikaziVoznjeDispecerSve").hide();
                $("#PrikazVozacaZaBan").hide();
                $("#PrikaziFiltriraneVoznjeDisp").show();
                $("#DodavanjeVoznjeDispecer").hide();
                $("#IzmjenaKorisnik1").hide();
                $("#PrikazKorisnik1").hide();
                $.get("/api/Voznja", function (data, status) {
                    let pom = `${$('#filterStatusDispCombo').val()}`
                    let pom2;
                    if (pom == "Kreirana") {
                        pom2 = 0;
                    } else if (pom == "Formirana") {
                        pom2 = 1;
                    } else if (pom == "Obradjena") {
                        pom2 = 2;
                    } else if (pom == "Prihvacena") {
                        pom2 = 3;
                    } else if (pom == "Otkazana") {
                        pom2 = 4;
                    } else if (pom == "Neuspjesna") {
                        pom2 = 5;
                    } else if (pom == "Uspjesna") {
                        pom2 = 6;
                    } else {
                        pom2 = 7;
                    }
                    let tableOfProducts = "<table border='1'>";
                    tableOfProducts += `<tr><th>Datum porudžbine</th><th>Ulica i br. dolaska</th><th>Mjesto dol.</th><th>Pozivni br. dol.</th><th>Status vož.</th><th>Komentarisao</th><th>Opis kom.</th><th>Ocjena kom.</th><th>Dat. obj. kom. vož.</th></tr>`;
                    for (voznja in data) {
                        if (dataP.KorisnickoIme == data[voznja].DispecerVoznja && pom2 == data[voznja].StatusVoznje) {
                            tableOfProducts += `<tr><td>${data[voznja].DTPorudzbine}</td><td>${data[voznja].Dolazak.Adresa.UlicaIBroj}</td><td>${data[voznja].Dolazak.Adresa.NaseljenoMjesto}</td><td>${data[voznja].Dolazak.Adresa.PozivniBroj}</td>`;
                            if (data[voznja].StatusVoznje == 0) {
                                tableOfProducts += '<td>Kreirana</td>';
                            } else if (data[voznja].StatusVoznje == 1) {
                                tableOfProducts += '<td>Formirana</td>';
                            } else if (data[voznja].StatusVoznje == 2) {
                                tableOfProducts += '<td>Obradjena</td>';
                            } else if (data[voznja].StatusVoznje == 3) {
                                tableOfProducts += '<td>Prihvacena</td>';
                            } else if (data[voznja].StatusVoznje == 4) {
                                tableOfProducts += '<td>Otkazana</td>';
                            } else if (data[voznja].StatusVoznje == 5) {
                                tableOfProducts += '<td>Neuspjesna</td>';
                            } else if (data[voznja].StatusVoznje == 6) {
                                tableOfProducts += '<td>Uspjesna</td>';
                            } else {
                                tableOfProducts += '<td>Utoku</td>';
                            }
                            tableOfProducts += `<td>${data[voznja].Komentar.KorImeKorisnikKomentar}</td><td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td></tr>`;
                        }
                    }
                    tableOfProducts += `<tr><td><select id="filterStatusDispCombo" name="StatusVoznje"><option value="Kreirana">Kreirana</option><option value="Formirana">Formirana</option><option value="Obradjena">Obradjena</option><option value="Prihvacena">Prihvacena</option><option value="Otkazana">Otkazana</option><option value="Neuspjesna">Neuspjesna</option><option value="Uspjesna">Uspjesna</option></select></td></tr></table><button id="filterStatusDispButton" type="button"><b>Filtriraj</b></button><button id="vratiSeDisp" type="button"><b>Izadji iz rezima filtriranja</b></button>`;
                    $("#PrikaziFiltriraneVoznjeDisp").html(tableOfProducts);

                });
            });

            $(document).on('click', '#vratiSeDisp', function () {
                $(location).attr('href', 'Korisnik.html');
            });



            $("#prikaziVoznjeSve").click(function () {
                $("#PrikaziVoznjeDispecerSve").show();
                $("#PrikazMusterijaZaBan").hide();
                $("#PrikaziFiltriraneVoznjeSveDisp").hide();
                $("#PrikaziFiltriraneVoznjeDisp").hide();
                $("#PrikazVozacaZaBan").hide();
                $("#PrikaziVoznjeDispecer").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#IzmjenaKorisnik1").hide();
                $("#PrikazKorisnik1").hide();
                $.get("/api/Voznja", function (data, status) {
                    let tableOfProducts = "<table border='1'>";
                    tableOfProducts += `<tr><th>Tip auta</th><th>Mušterija vožnje</th><th>Datum porudž.</th><th>Ulica i br. dolaska</th><th>Mjesto dol.</th><th>Status vož.</th><th>Vozač</th><th>Opis kom.</th><th>Ocjena kom.</th><th>Dat. obj. kom. vož.</th></tr>`;
                    for (voznja in data) {
                        if (data[voznja].TipAutaVoznje == 0) {
                            tableOfProducts += '<tr><td>Putnički</td>';
                        }
                        else {
                            tableOfProducts += '<tr><td>Kombi</td>';
                        }
                        tableOfProducts += `<td>${data[voznja].MusterijaVoznja}</td><td>${data[voznja].DTPorudzbine}</td><td>${data[voznja].Dolazak.Adresa.UlicaIBroj}</td><td>${data[voznja].Dolazak.Adresa.NaseljenoMjesto}</td>`;
                        if (data[voznja].StatusVoznje == 0) {
                            tableOfProducts += '<td>Kreirana</td>';
                        } else if (data[voznja].StatusVoznje == 1) {
                            tableOfProducts += '<td>Formirana</td>';
                        } else if (data[voznja].StatusVoznje == 2) {
                            tableOfProducts += '<td>Obradjena</td>';
                        } else if (data[voznja].StatusVoznje == 3) {
                            tableOfProducts += '<td>Prihvacena</td>';
                        } else if (data[voznja].StatusVoznje == 4) {
                            tableOfProducts += '<td>Otkazana</td>';
                        } else if (data[voznja].StatusVoznje == 5) {
                            tableOfProducts += '<td>Neuspjesna</td>';
                        } else if (data[voznja].StatusVoznje == 6) {
                            tableOfProducts += '<td>Uspjesna</td>';
                        } else {
                            tableOfProducts += '<td>Utoku</td>';
                        }

                        if ((data[voznja].StatusVoznje == 0 && data[voznja].VozacVoznja == "") || (data[voznja].StatusVoznje == 0 && data[voznja].VozacVoznja == null)) {
                            tableOfProducts += `<td>${data[voznja].VozacVoznja}</td><td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="dispecerDodajVozaca" type="button" value=${data[voznja].IdVoznje}><b>Dodaj vozaca</b></button></td></tr>`;
                        } else {
                            tableOfProducts += `<td>${data[voznja].VozacVoznja}</td><td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="dispecerDodajVozaca" type="button" value ="disable" disabled="disabled"><b>Dodaj vozaca</b></button></td></tr>`;
                        }

                    }
                    tableOfProducts += `<tr><td><select id="filterStatusDispSveCombo" name="StatusVoznje"><option value="Kreirana">Kreirana</option><option value="Formirana">Formirana</option><option value="Obradjena">Obradjena</option><option value="Prihvacena">Prihvacena</option><option value="Otkazana">Otkazana</option><option value="Neuspjesna">Neuspjesna</option><option value="Uspjesna">Uspjesna</option></select></td></tr></table><button id="filterStatusDispSveButton" type="button"><b>Filtriraj</b></button>`;
                    $("#PrikaziVoznjeDispecerSve").html(tableOfProducts);
                });
            });



            $(document).on('click', '#filterStatusDispSveButton', function () {
                $("#PrikaziFiltriraneVoznjeSveDisp").show();
                $("#PrikaziVoznjeDispecerSve").hide();
                $("#PrikaziFiltriraneVoznjeDisp").hide();
                $("#PrikaziVoznjeDispecer").hide();
                $("#PrikazVozacaZaBan").hide();
                $("#PrikazMusterijaZaBan").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#IzmjenaKorisnik1").hide();
                $("#PrikazKorisnik1").hide();
                $.get("/api/Voznja", function (data, status) {
                    let pom = `${$('#filterStatusDispSveCombo').val()}`
                    let pom3;
                    if (pom == "Kreirana") {
                        pom3 = 0;
                    } else if (pom == "Formirana") {
                        pom3 = 1;
                    } else if (pom == "Obradjena") {
                        pom3 = 2;
                    } else if (pom == "Prihvacena") {
                        pom3 = 3;
                    } else if (pom == "Otkazana") {
                        pom3 = 4;
                    } else if (pom == "Neuspjesna") {
                        pom3 = 5;
                    } else if (pom == "Uspjesna") {
                        pom3 = 6;
                    } else {
                        pom3 = 7;
                    }
                    let tableOfProducts = "<table border='1'>";
                    tableOfProducts += `<tr><th>Tip auta</th><th>Mušterija vožnje</th><th>Datum porudž.</th><th>Ulica i br. dolaska</th><th>Mjesto dol.</th><th>Pozivni br. dol.</th><th>Status vož.</th><th>Vozač</th><th>Opis kom.</th><th>Ocjena kom.</th><th>Dat. obj. kom. vož.</th></tr>`;
                    for (voznja in data) {
                        if (pom3 == data[voznja].StatusVoznje) {
                            if (data[voznja].TipAutaVoznje == 0) {
                                tableOfProducts += '<tr><td>Putnički</td>';
                            }
                            else {
                                tableOfProducts += '<tr><td>Kombi</td>';
                            }
                            tableOfProducts += `<td>${data[voznja].MusterijaVoznja}</td><td>${data[voznja].DTPorudzbine}</td><td>${data[voznja].Dolazak.Adresa.UlicaIBroj}</td><td>${data[voznja].Dolazak.Adresa.NaseljenoMjesto}</td><td>${data[voznja].Dolazak.Adresa.PozivniBroj}</td>`;
                            if (data[voznja].StatusVoznje == 0) {
                                tableOfProducts += '<td>Kreirana</td>';
                            } else if (data[voznja].StatusVoznje == 1) {
                                tableOfProducts += '<td>Formirana</td>';
                            } else if (data[voznja].StatusVoznje == 2) {
                                tableOfProducts += '<td>Obradjena</td>';
                            } else if (data[voznja].StatusVoznje == 3) {
                                tableOfProducts += '<td>Prihvacena</td>';
                            } else if (data[voznja].StatusVoznje == 4) {
                                tableOfProducts += '<td>Otkazana</td>';
                            } else if (data[voznja].StatusVoznje == 5) {
                                tableOfProducts += '<td>Neuspjesna</td>';
                            } else if (data[voznja].StatusVoznje == 6) {
                                tableOfProducts += '<td>Uspjesna</td>';
                            } else {
                                tableOfProducts += '<td>Utoku</td>';
                            }

                            if ((data[voznja].StatusVoznje == 0 && data[voznja].VozacVoznja == "") || (data[voznja].StatusVoznje == 0 && data[voznja].VozacVoznja == null)) {
                                tableOfProducts += `<td>${data[voznja].VozacVoznja}</td><td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="dispecerDodajVozaca" type="button" value=${data[voznja].IdVoznje}><b>Dodaj vozaca</b></button></td></tr>`;
                            } else {
                                tableOfProducts += `<td>${data[voznja].VozacVoznja}</td><td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="dispecerDodajVozaca" type="button" value ="disable" disabled="disabled"><b>Dodaj vozaca</b></button></td></tr>`;
                            }
                        }
                    }
                    tableOfProducts += `<tr><td><select id="filterStatusDispSveCombo" name="StatusVoznje"><option value="Kreirana">Kreirana</option><option value="Formirana">Formirana</option><option value="Obradjena">Obradjena</option><option value="Prihvacena">Prihvacena</option><option value="Otkazana">Otkazana</option><option value="Neuspjesna">Neuspjesna</option><option value="Uspjesna">Uspjesna</option></select></td></tr></table><button id="filterStatusDispSveButton" type="button"><b>Filtriraj</b></button><button id="vratiSeDisp" type="button"><b>Izadji iz rezima filtriranja</b></button>`;
                    $("#PrikaziFiltriraneVoznjeSveDisp").html(tableOfProducts);
                });
            });


            $("#prikaziVoznjeVozac").click(function () {
                $("#PrikaziVoznjeVozac").show();
                $("#IzmjenaKorisnik2").hide();
                $("#PrikazKorisnik2").hide();
                $("#KomentarNeuspjesnaVoznja").hide();
                $("#PrikaziKreiraneVoznjeVozac").hide();
                $("#PrikaziFiltriraneVoznjeVozac").hide();
                $("#UspjesnaVoznjaNoComm").hide();

                $.get("/api/Voznja", function (data, status) {
                    let tableOfProducts = "<table border='1'>";
                    tableOfProducts += `<tr><th>Mušterija vožnje</th><th>Datum porudžbine</th><th>Ulica i br. dolaska</th><th>Mjesto dol.</th><th>Pozivni br. dol.</th><th>Status vož.</th><th>Opis kom.</th><th>Ocjena kom.</th><th>Dat. obj. kom. vož.</th><th> </th><th> </th></tr>`;
                    for (voznja in data) {
                        if (dataP.KorisnickoIme == data[voznja].VozacVoznja) {
                            tableOfProducts += `<tr><td>${data[voznja].MusterijaVoznja}</td><td>${data[voznja].DTPorudzbine}</td><td>${data[voznja].Dolazak.Adresa.UlicaIBroj}</td><td>${data[voznja].Dolazak.Adresa.NaseljenoMjesto}</td><td>${data[voznja].Dolazak.Adresa.PozivniBroj}</td>`;
                            if (data[voznja].StatusVoznje == 0) {

                                tableOfProducts += '<td>Kreirana</td>';
                            } else if (data[voznja].StatusVoznje == 1) {
                                tableOfProducts += '<td>Formirana</td>';
                            } else if (data[voznja].StatusVoznje == 2) {
                                tableOfProducts += '<td>Obradjena</td>';
                            } else if (data[voznja].StatusVoznje == 3) {
                                tableOfProducts += '<td>Prihvacena</td>';
                            } else if (data[voznja].StatusVoznje == 4) {
                                tableOfProducts += '<td>Otkazana</td>';
                            } else if (data[voznja].StatusVoznje == 5) {
                                tableOfProducts += '<td>Neuspjesna</td>';
                            } else if (data[voznja].StatusVoznje == 6) {
                                tableOfProducts += '<td>Uspjesna</td>';
                            } else {
                                tableOfProducts += '<td>Utoku</td>';
                            }

                            if (data[voznja].StatusVoznje == 1 || data[voznja].StatusVoznje == 2 || data[voznja].StatusVoznje == 3) {
                                tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="uspjesnaVoznja" type="button" value=${data[voznja].IdVoznje}><b>Uspjesna voznja</b></button></td><td><button id="neuspjesnaVoznjaKomentar" type="button" value=${data[voznja].IdVoznje}><b>Neuspjesna voznja</b></button></td></tr>`;
                            } else if (data[voznja].StatusVoznje == 5 || data[voznja].StatusVoznje == 6) {
                                tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="uspjesnaVoznja" type="button" value ="disable" disabled="disabled"><b>Uspjesna voznja</b></button></td><td><button id="neuspjesnaVoznjaKomentar" type="button" value ="disable" disabled="disabled"><b>Neuspjesna voznja</b></button></td></tr>`;
                            } else {

                            }
                        }
                    }
                    tableOfProducts += `<tr><td><select id="filterStatusVozacCombo" name="StatusVoznje"><option value="Kreirana">Kreirana</option><option value="Formirana">Formirana</option><option value="Obradjena">Obradjena</option><option value="Prihvacena">Prihvacena</option><option value="Otkazana">Otkazana</option><option value="Neuspjesna">Neuspjesna</option><option value="Uspjesna">Uspjesna</option></select></td></tr></table><button id="filterStatusVozacButton" type="button"><b>Filtriraj</b></button>`;
                    $("#PrikaziVoznjeVozac").html(tableOfProducts);
                });
            });



            $(document).on('click', '#filterStatusVozacButton', function () {  //zafilter
                $("#PrikaziVoznjeVozac").hide();
                $("#IzmjenaKorisnik2").hide();
                $("#PrikazKorisnik2").hide();
                $("#PrikaziFiltriraneVoznjeVozac").show();
                $("#KomentarNeuspjesnaVoznja").hide();
                $("#PrikaziKreiraneVoznjeVozac").hide();
                $("#UspjesnaVoznjaNoComm").hide();

                $.get("/api/Voznja", function (data, status) {
                    let pom = `${$('#filterStatusVozacCombo').val()}`
                    let pom3;
                    if (pom == "Kreirana") {
                        pom3 = 0;
                    } else if (pom == "Formirana") {
                        pom3 = 1;
                    } else if (pom == "Obradjena") {
                        pom3 = 2;
                    } else if (pom == "Prihvacena") {
                        pom3 = 3;
                    } else if (pom == "Otkazana") {
                        pom3 = 4;
                    } else if (pom == "Neuspjesna") {
                        pom3 = 5;
                    } else if (pom == "Uspjesna") {
                        pom3 = 6;
                    } else {
                        pom3 = 7;
                    }
                    let tableOfProducts = "<table border='1'>";
                    tableOfProducts += `<tr><th>Mušterija vožnje</th><th>Datum porudžbine</th><th>Ulica i br. dolaska</th><th>Mjesto dol.</th><th>Pozivni br. dol.</th><th>Status vož.</th><th>Opis kom.</th><th>Ocjena kom.</th><th>Dat. obj. kom. vož.</th><th> </th><th> </th></tr>`;
                    for (voznja in data) {
                        if (dataP.KorisnickoIme == data[voznja].VozacVoznja && data[voznja].StatusVoznje == pom3) {
                            tableOfProducts += `<tr><td>${data[voznja].MusterijaVoznja}</td><td>${data[voznja].DTPorudzbine}</td><td>${data[voznja].Dolazak.Adresa.UlicaIBroj}</td><td>${data[voznja].Dolazak.Adresa.NaseljenoMjesto}</td><td>${data[voznja].Dolazak.Adresa.PozivniBroj}</td>`;
                            if (data[voznja].StatusVoznje == 0) {

                                tableOfProducts += '<td>Kreirana</td>';
                            } else if (data[voznja].StatusVoznje == 1) {
                                tableOfProducts += '<td>Formirana</td>';
                            } else if (data[voznja].StatusVoznje == 2) {
                                tableOfProducts += '<td>Obradjena</td>';
                            } else if (data[voznja].StatusVoznje == 3) {
                                tableOfProducts += '<td>Prihvacena</td>';
                            } else if (data[voznja].StatusVoznje == 4) {
                                tableOfProducts += '<td>Otkazana</td>';
                            } else if (data[voznja].StatusVoznje == 5) {
                                tableOfProducts += '<td>Neuspjesna</td>';
                            } else if (data[voznja].StatusVoznje == 6) {
                                tableOfProducts += '<td>Uspjesna</td>';
                            } else {
                                tableOfProducts += '<td>Utoku</td>';
                            }

                            if (data[voznja].StatusVoznje == 1 || data[voznja].StatusVoznje == 2 || data[voznja].StatusVoznje == 3) {
                                tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="uspjesnaVoznja" type="button" value=${data[voznja].IdVoznje}><b>Uspjesna voznja</b></button></td><td><button id="neuspjesnaVoznjaKomentar" type="button" value=${data[voznja].IdVoznje}><b>Neuspjesna voznja</b></button></td></tr>`;
                            } else if (data[voznja].StatusVoznje == 5 || data[voznja].StatusVoznje == 6) {
                                tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="uspjesnaVoznja" type="button" value ="disable" disabled="disabled"><b>Uspjesna voznja</b></button></td><td><button id="neuspjesnaVoznjaKomentar" type="button" value ="disable" disabled="disabled"><b>Neuspjesna voznja</b></button></td></tr>`;
                            } else {

                            }
                        }
                    }
                    tableOfProducts += `<tr><td><select id="filterStatusVozacCombo" name="StatusVoznje"><option value="Kreirana">Kreirana</option><option value="Formirana">Formirana</option><option value="Obradjena">Obradjena</option><option value="Prihvacena">Prihvacena</option><option value="Otkazana">Otkazana</option><option value="Neuspjesna">Neuspjesna</option><option value="Uspjesna">Uspjesna</option></select></td></tr></table><button id="filterStatusVozacButton" type="button"><b>Filtriraj</b></button><button id="vratiSeDisp" type="button"><b>Izadji iz rezima filtriranja</b></button>`;
                    $("#PrikaziFiltriraneVoznjeVozac").html(tableOfProducts);
                });
            });




            $("#prikaziKreiraneVoznjeVozac").click(function () {
                $("#PrikaziVoznjeVozac").hide();
                $("#PrikaziKreiraneVoznjeVozac").show();
                $("#IzmjenaKorisnik2").hide();
                $("#PrikazKorisnik2").hide();
                $("#KomentarNeuspjesnaVoznja").hide();
                $("#UspjesnaVoznjaNoComm").hide();

                $.get("/api/Voznja", function (data, status) {
                    let tableOfProducts = "<table border='1'>";
                    tableOfProducts += `<tr><th>Mušterija vožnje</th><th>Datum porudžbine</th><th>Ulica i br. dolaska</th><th>Mjesto dol.</th><th>Pozivni br. dol.</th><th>Status vož.</th><th>Opis kom.</th><th>Ocjena kom.</th><th>Dat. obj. kom. vož.</th><th> </th></tr>`;
                    for (voznja in data) {
                        if (data[voznja].StatusVoznje == 0 && (data[voznja].TipAutaVoznje == dataP.Automobil.TipAuta)) {
                            tableOfProducts += `<tr><td>${data[voznja].MusterijaVoznja}</td><td>${data[voznja].DTPorudzbine}</td><td>${data[voznja].Dolazak.Adresa.UlicaIBroj}</td><td>${data[voznja].Dolazak.Adresa.NaseljenoMjesto}</td><td>${data[voznja].Dolazak.Adresa.PozivniBroj}</td><td>Kreirana</td>`;
                            tableOfProducts += `<td>${data[voznja].Komentar.Opis}</td><td>${data[voznja].Komentar.Ocjena}</td><td>${data[voznja].Komentar.DTObjave}</td><td><button id="prihvatiVoznju" type="button" value=${data[voznja].IdVoznje}><b>Prihvati voznju</b></button></td></tr>`;

                        }
                    }
                    tableOfProducts += "</table>";
                    $("#PrikaziKreiraneVoznjeVozac").html(tableOfProducts);
                });
            });



            $(document).on('click', '#prihvatiVoznju', function () {
                let id6 = $(this).val();
                $("#PrikaziVoznjeVozac").hide();
                $("#IzmjenaKorisnik2").hide();
                $("#PrikazKorisnik2").hide();
                $("#PrikaziKreiraneVoznjeVozac").show();
                $("#PrikaziFiltriraneVoznjeVozac").hide();

                let voznja = {
                    VozacVoznja: dataP.KorisnickoIme,
                    Iznos: 0,
                    DispecerVoznja: null,
                    StatusVoznje: "Prihvacena",

                };


                $.ajax({
                    type: 'PUT',
                    url: '/api/Voznja/' + id6,
                    data: JSON.stringify(voznja),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert('Uspjesno prihvacena voznja');
                            $(location).attr('href', 'Korisnik.html');
                        } else {
                            alert('Ne postoji voznja koju zelite da prihvatite');
                        }
                    },
                })
            });


            $(document).on('click', '#dispecerDodajVozaca', function () {  // za dispecera  dodavanje vozaca na voznju,5 najblizih u zavisnosti od lokacije musterije
                let fired_button2 = $(this).val();
                localStorage.setItem("dodajVozaca", fired_button2);
                let x1; //musterija
                let y1;

                let udaljenost;

                let type;

                $.ajax({
                    type: 'GET',
                    url: '/api/Voznja',
                    async: false,
                    success: function (data) {
                        for (voznja in data) {
                            if (data[voznja].IdVoznje == fired_button2) {
                                type = data[voznja].TipAutaVoznje;
                                x1 = data[voznja].Dolazak.X;
                                y1 = data[voznja].Dolazak.Y;
                            }
                        }
                    }
                });





                //$.get("/api/Vozac", function (data, status) {

                $.ajax({
                    type: 'GET',
                    url: '/api/Vozac',
                    async: false,
                    success: function (data) {

                        let pom = type;
                        let koliko = 0;
                        let listaUdaljenosti = [];
                        let udaljenost;
                        let table = "<table border='1'><tr><td><select id=\"vozac1\" name=\"VozacVoznja\">";
                        if (Object.keys(data).length > 5) {


                            for (driver1 in data) {
                                let oduzetX = x1 - data[driver1].Lokacija.X;
                                let oduzetY = y1 - data[driver1].Lokacija.Y;
                                udaljenost = Math.sqrt(Math.pow(oduzetX, 2) + Math.pow(oduzetY, 2));


                                listaUdaljenosti.push({
                                    'udaljenost': udaljenost,
                                    'vozac': data[driver1]
                                });
                            }

                            listaUdaljenosti.sort(function (a, b) {
                                return a.udaljenost - b.udaljenost;
                            });


                            let brojac = 0;
                            for (u in listaUdaljenosti) {
                                brojac++;
                                for (driver in data) {
                                    if (listaUdaljenosti[u].vozac.Id == data[driver].Id) {
                                        if (data[driver].Automobil.TipAuta == pom && data[driver].Zauzet == false) {  //5 najblizih u zavisnosti od lokacije musterije
                                            table += "<option>" + data[driver].KorisnickoIme + "</option>";
                                            koliko++;
                                        }
                                    }
                                }
                                if (brojac == 5) {
                                    break;
                                }
                            }

                        } else {


                            for (driver in data) {
                                if (data[driver].Automobil.TipAuta == pom && data[driver].Zauzet == false) {  //ako ima manje od 5 vozaca ukupno
                                    table += "<option>" + data[driver].KorisnickoIme + "</option>";
                                    koliko++;
                                }

                            }
                        }
                        table += "</select></td></tr></table><button id=\"dispecerDodajVozaca2\" type=\"button\"><b>Dodaj voznju</b></button>";

                        if (koliko == 0) {
                            alert('Trenutno nema slobodnih vozača sa traženim automobilom.');
                            $(location).attr('href', 'Korisnik.html');
                        } else {
                            $("#DodajVozacaDispecer").append(table);
                        }
                    }
                });

            });


            $(document).on('click', '#dispecerDodajVozaca2', function () {   //Znam... za dodavanje vozaca voznji
                let id3 = localStorage.getItem("dodajVozaca");
                $("#PrikaziVoznjeDispecerSve").hide();
                $("#PrikaziVoznjeDispecer").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#IzmjenaKorisnik1").hide();
                $("#PrikazKorisnik1").hide();
                $("#PrikazVozacaZaBan").hide();
                $("#PrikaziFiltriraneVoznjeDisp").hide();
                $("#PrikaziFiltriraneVoznjeSveDisp").hide();
                $("#DodajVozacaDispecer").hide();


                let voznja = {
                    VozacVoznja: `${$('#vozac1').val()}`,
                    Iznos: 0,
                    DispecerVoznja: dataP.KorisnickoIme,
                    StatusVoznje: "Kreirana",
                };


                $.ajax({
                    type: 'PUT',
                    url: '/api/Voznja/' + id3,
                    data: JSON.stringify(voznja),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert('Uspjesno dodat vozac');
                            localStorage.setItem("dodajVozaca", id3);
                            $(location).attr('href', 'Korisnik.html');
                        } else {
                            alert('Ne postoji vozac sa zeljenim tipom automobila');
                        }
                    },
                })
            });



            $(document).on('click', '#neuspjesnaVoznjaKomentar', function () {
                let fired_button7 = $(this).val();
                localStorage.setItem("neuspjesnaVoznja", fired_button7);
                $("#IzmjenaKorisnik2").hide();
                $("#PrikazKorisnik2").hide();
                $("#PrikaziVoznjeVozac").hide();
                $("#KomentarNeuspjesnaVoznja").show();
                $("#PrikaziKreiraneVoznjeVozac").hide();
                $("#UspjesnaVoznjaNoComm").hide();
                $("#PrikaziFiltriraneVoznjeVozac").hide();


                $.get("/api/Voznja", function (data, status) {
                    let id = localStorage.getItem("neuspjesnaVoznja");
                    let tableofData7 = "<table border='1'>";
                    for (voznja in data) {
                        if (data[voznja].IdVoznje == id) {
                            tableofData7 += "<tr><td>Opis</td><td><input id=\"opis1\" type=\"text\" name=\"Opis\" value=\"" + data[voznja].Komentar.Opis + "\"/></td></tr>" +
                                "<tr><td>Ocjena</td><td><input id=\"ocjena1\" min=\"0\" max=\"5\" type=\"number\" name=\"Ocjena\" value=\"" + data[voznja].Komentar.Ocjena + "\"/></td></tr>";
                        }
                    }
                    tableofData7 += "</table>";
                    $("#IzmjenaShow7").html(tableofData7);
                });
            });



            $("#neuspjesnaVoznjaPotvrdi").click(function () {
                let id8 = localStorage.getItem("neuspjesnaVoznja");
                let dt = new Date();
                let komentarVoznja1 = {
                    Opis: `${$('#opis1').val()}`,
                    DTObjave: dt.toLocaleString(),  //new Date($.now());
                    Ocjena: `${$('#ocjena1').val()}`,
                    KorImeKorisnikKomentar: dataP.KorisnickoIme,
                    IdVoznjaKomentar: id8,
                };

                let voznja1 = {
                    VozacVoznja: dataP.KorisnickoIme,
                    Iznos: 0,
                    Komentar: komentarVoznja1,
                    StatusVoznje: "Neuspjesna",

                };

                $.ajax({
                    type: 'PUT',
                    url: '/api/Voznja/' + id8,
                    data: JSON.stringify(voznja1),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert('Neuspjesna voznja');
                            $(location).attr('href', 'Korisnik.html');
                        } else {
                            alert('Ne postoji voznja koju zelite proglasiti neuspjesnom.');
                        }
                    },
                })


            });

            $(document).on('click', '#uspjesnaVoznja', function () {
                let fired_button9 = $(this).val();
                localStorage.setItem("uspjesnaVoznja", fired_button9);
                $("#IzmjenaKorisnik2").hide();
                $("#PrikazKorisnik2").hide();
                $("#PrikaziVoznjeVozac").hide();
                $("#KomentarNeuspjesnaVoznja").hide();
                $("#UspjesnaVoznjaNoComm").show();
                $("#UspjesnaVoznjaKomentar").hide();
                $("#PrikaziKreiraneVoznjeVozac").hide();
                $("#PrikaziFiltriraneVoznjeVozac").hide();
                $("#map").show();




                $.get("/api/Voznja", function (data, status) {
                    let id = localStorage.getItem("uspjesnaVoznja");
                    let tableofData10 = "<table border='1'>";
                    for (voznja in data) {
                        if (data[voznja].IdVoznje == id) {
                            tableofData10 +=
                                "<tr><td>Iznos</td><td><input id=\"iznosodredista\" type=\"text\" name=\"Iznos\" value=\"" + data[voznja].Iznos + "\"/></td></tr>";
                        }
                    }
                    tableofData10 += "</table></button>";
                    $("#IzmjenaShow10").html(tableofData10);


                });
            });




            $("#potvrdiUnos").click(function () {
                let id10 = localStorage.getItem("uspjesnaVoznja");
                $("#PrikaziVoznjeVozac").hide();
                $("#IzmjenaKorisnik2").hide();
                $("#PrikazKorisnik2").hide();
                $("#UspjesnaVoznjaNoComm").show();
                $("#UspjesnaVoznjaKomentar").show();
                $("#PrikaziKreiraneVoznjeVozac").hide();
                $("#PrikaziFiltriraneVoznjeVozac").hide();
                $("#map").hide();


                let dijelovi = fulAdresa.split(",");
                let x = dijelovi[0];
                let y = dijelovi[1];
                let ulicaIbroj = dijelovi[2];
                let grad = dijelovi[3]; //ima i zip

                let adresaOdrediste = {
                    IdAdr: "",
                    UlicaIBroj: ulicaIbroj,
                    NaseljenoMjesto: grad,
                    PozivniBroj: "",
                };

                let lokacijaOdrediste = {
                    IdLok: "",
                    X: x,
                    Y: y,
                    Adresa: adresaOdrediste,
                };


                let voznja10 = {
                    VozacVoznja: dataP.KorisnickoIme,
                    Odrediste: lokacijaOdrediste,
                    Iznos: `${$('#iznosodredista').val()}`,
                    StatusVoznje: "Uspjesna",
                };


                $.ajax({
                    type: 'PUT',
                    url: '/api/Voznja/' + id10,
                    data: JSON.stringify(voznja10),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (data) {
                        if (data) {
                            alert('Uspjesna voznja');
                            $(location).attr('href', 'Korisnik.html');
                        } else {
                            alert('Ne postoji voznja koju zelite proglasiti uspjesnom.');
                        }
                    },
                })
            });









            $("#prikaziMusterijeBan").click(function () {   ///za banovanje
                $("#PrikazMusterijaZaBan").show();
                $("#PrikaziVoznjeDispecerSve").hide();
                $("#PrikaziVoznjeDispecer").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#PrikazVozacaZaBan").hide();
                $("#IzmjenaKorisnik1").hide();
                $("#PrikazKorisnik1").hide();
                $("#PrikaziFiltriraneVoznjeDisp").hide();
                $("#PrikaziFiltriraneVoznjeSveDisp").hide();
                $("#DodajVozacaDispecer").hide();


                $.get("/api/Musterija", function (data, status) {
                    let tableOfProducts = "<table border='1'>";
                    tableOfProducts += `<tr><th>Korisnicko ime</th><th>Ime</th><th> </th><th> </th></tr>`;
                    for (must in data) {
                        tableOfProducts += `<tr><td>${data[must].KorisnickoIme}</td><td>${data[must].Ime}</td>`;
                        if (data[must].Banovan == false) {
                            tableOfProducts += `<td><button id="banujMusteriju" type="button" value=${data[must].Id}><b>Banuj</b></button></td><td><button id="odbanujMusteriju" type="button" value ="disable" disabled="disabled"><b>Odbanuj</b></button></td></tr>`;
                        } else if (data[must].Banovan == true) {
                            tableOfProducts += `<td><button id="banujMusteriju" type="button" value ="disable" disabled="disabled"><b>Banuj</b></button></td><td><button id="odbanujMusteriju" type="button" value=${data[must].Id}><b>Odbanuj</b></button></td></tr>`;
                        }
                    }
                    tableOfProducts += `</table>`;
                    $("#PrikazMusterijaZaBan").html(tableOfProducts);
                });
            });



            $(document).on('click', '#banujMusteriju', function () {
                let fired_button20 = $(this).val();
                localStorage.setItem("banujGa", fired_button20);
                $("#PrikazMusterijaZaBan").show();
                $("#PrikaziVoznjeDispecerSve").hide();
                $("#PrikaziVoznjeDispecer").hide();
                $("#PrikazVozacaZaBan").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#IzmjenaKorisnik1").hide();
                $("#PrikazKorisnik1").hide();
                $("#PrikaziFiltriraneVoznjeDisp").hide();
                $("#PrikaziFiltriraneVoznjeSveDisp").hide();
                $("#DodajVozacaDispecer").hide();




                $.get("/api/Musterija", function (data, status) {
                    let id = localStorage.getItem("banujGa");

                    for (must in data) {
                        if (data[must].Id == id) {
                            data[must].Banovan = true;
                            async: false;

                            let korisnik = {
                                Id: id,
                                Banovan: true,
                            };

                            $.ajax({
                                type: 'PUT',
                                url: '/api/Musterija/' + id,
                                data: JSON.stringify(korisnik),
                                contentType: 'application/json; charset=utf-8',
                                dataType: 'json',
                                success: function (data) {
                                    if (data) {
                                        alert('Uspjesno banovana musterija');
                                        $(location).attr('href', 'Korisnik.html');
                                    } else {
                                        alert('Ne postoji musterija koju zelite da banujete');
                                    }
                                },
                            });

                        }
                    }
                });

            });




            $(document).on('click', '#odbanujMusteriju', function () {
                let fired_button20 = $(this).val();
                localStorage.setItem("odbanujGa", fired_button20);
                $("#PrikazMusterijaZaBan").show();
                $("#PrikaziVoznjeDispecerSve").hide();
                $("#PrikaziVoznjeDispecer").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#PrikazVozacaZaBan").hide();
                $("#IzmjenaKorisnik1").hide();
                $("#PrikazKorisnik1").hide();
                $("#PrikaziFiltriraneVoznjeDisp").hide();
                $("#PrikaziFiltriraneVoznjeSveDisp").hide();
                $("#DodajVozacaDispecer").hide();




                $.get("/api/Musterija", function (data, status) {
                    let id = localStorage.getItem("odbanujGa");

                    for (must in data) {
                        if (data[must].Id == id) {
                            data[must].Banovan = false;
                            async: false;

                            let korisnik = {
                                Id: id,
                                Banovan: false,
                            };

                            $.ajax({
                                type: 'PUT',
                                url: '/api/Musterija/' + id,
                                data: JSON.stringify(korisnik),
                                contentType: 'application/json; charset=utf-8',
                                dataType: 'json',
                                success: function (data) {
                                    if (data) {
                                        alert('Uspjesno odbanovana musterija');

                                        $(location).attr('href', 'Korisnik.html');
                                    } else {
                                        alert('Ne postoji musterija koju zelite da odbanujete');
                                    }
                                },
                            });

                        }
                    }
                });

            });



            $("#prikaziVozaceBan").click(function () {   ///za banovanje vozaca
                $("#PrikazVozacaZaBan").show();
                $("#PrikazMusterijaZaBan").hide();
                $("#PrikaziVoznjeDispecerSve").hide();
                $("#PrikaziVoznjeDispecer").hide();
                $("#DodavanjeVoznjeMusterija").hide();
                $("#IzmjenaKorisnik1").hide();
                $("#PrikazKorisnik1").hide();
                $("#PrikaziFiltriraneVoznjeDisp").hide();
                $("#PrikaziFiltriraneVoznjeSveDisp").hide();
                $("#DodajVozacaDispecer").hide();


                $.get("/api/Vozac", function (data, status) {
                    let tableOfProducts = "<table border='1'>";
                    tableOfProducts += `<tr><th>Korisnicko ime</th><th>Ime</th><th> </th><th> </th></tr>`;
                    for (voz in data) {
                        tableOfProducts += `<tr><td>${data[voz].KorisnickoIme}</td><td>${data[voz].Ime}</td>`;
                        if (data[voz].Banovan == false) {
                            tableOfProducts += `<td><button id="banujVozaca" type="button" value=${data[voz].Id}><b>Banuj</b></button></td><td><button id="odbanujVozaca" type="button" value ="disable" disabled="disabled"><b>Odbanuj</b></button></td></tr>`;
                        } else if (data[voz].Banovan == true) {
                            tableOfProducts += `<td><button id="banujVozaca" type="button" value ="disable" disabled="disabled"><b>Banuj</b></button></td><td><button id="odbanujVozaca" type="button" value=${data[voz].Id}><b>Odbanuj</b></button></td></tr>`;
                        }
                    }
                    tableOfProducts += `</table>`;
                    $("#PrikazVozacaZaBan").html(tableOfProducts);
                });
            });



        });



    </script>

    <style>
        body {
            background-image: url("pozadina.jpg");
            background-repeat: no-repeat;
            background-position: inherit;
            background-size: cover;
        }

        #naslovna {
            background-color: red;
            height: 40px;
        }

        #naslovP {
            text-align: center;
        }
    </style>
</head>
<body>

    </table>
    <button id="pretragaStartMust" type="button"><b>Izaberite limit pretrage</b></button>
    </div>


    </div>


    <div id="divDispecer">
        <p><b>Wecome dispatcher!</b></p>
        <button id="prikaziVoznjeDisp" type="button"><b>Prikazi voznje dispecera</b></button>
        <button id="prikaziVoznjeSve" type="button"><b>Prikazi sve voznje</b></button>
        <button id="prikaziKorisnik1" type="button"><b>Prikazi podatke</b></button>
        <button id="izmjeniKorisnik1" type="button"><b>Izmeni podatke</b></button>
        <button id="dodajVozaca" type="button"><b> Dodaj vozaca </b></button>
        <button id="dodajVoznjuDisp" type="button"><b>Naruci voznju</b></button>
        <button id="prikaziMusterijeBan" type="button"><b>Prikazi musterije</b></button>
        <button id="prikaziVozaceBan" type="button"><b>Prikazi vozace</b></button>

        <div id="PrikazVozacaZaBan"></div>
        <div id="PrikazMusterijaZaBan"></div>
        <div id="DodajVozacaDispecer"></div>
        <div id="PrikaziFiltriraneVoznjeDisp"></div>
        <div id="PrikaziFiltriraneVoznjeSveDisp"></div>
        <div id="PrikaziVoznjeDispecer"></div>
        <div id="PrikaziVoznjeDispecerSve"></div>
        <div id="PrikazKorisnik1"></div>
        <div id="IzmjenaKorisnik1">
            <div id="IzmjenaShow1"></div>
            <button id="potvrdiIzmjenu1" type="button"><b>Izmeni podatke</b></button>
        </div>
        <div id="DodavanjeVozaca">
            <table border=1>
                <tr>
                    <td><b>Korisnicko ime</b></td>
                    <td><input id="korImeReg1" type="text" name="KorisnickoIme" required /></td>
                </tr>
                <tr>
                    <td><b>Lozinka</b></td>
                    <td><input id="korPassReg1" type="password" name="Lozinka" required /></td>
                </tr>
                <tr>
                    <td><b>Ime</b></td>
                    <td><input id="ime1" type="text" name="Ime" required /></td>
                </tr>
                <tr>
                    <td><b>Prezime</b></td>
                    <td><input id="prezime1" type="text" name="Prezime" required /></td>
                </tr>

                <tr>
                    <td><b>JMBG</b></td>
                    <td><input id="jmbg1" type="text" name="JMBG" required /></td>
                </tr>
                <tr>
                    <td><b>Pol</b></td>
                    <td>
                        <select name="Pol" id="pol1">
                            <option>
                                Z
                            </option>
                            <option>
                                M
                            </option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><b>Broj telefona</b></td>
                    <td><input id="brTelefona1" type="text" name="KontaktTelefon" required /></td>
                </tr>
                <tr>
                    <td><b>Email adresa</b></td>
                    <td><input id="email1" type="email" name="Email" required /></td>
                </tr>
                <tr>
                    <td><b>Godiste automobila</b></td>
                    <td><input id="godiste" type="text" name="Godiste" required /></td>
                </tr>
                <tr>
                    <td><b>Registracija</b></td>
                    <td><input id="registracija" type="text" name="Registracija" required /></td>
                </tr>
                <tr>
                    <td><b>Broj vozila</b></td>
                    <td><input id="brojvozila" type="text" name="BrojVozila" required /></td>
                </tr>

                <tr>
                    <td><b>Tip automobila</b></td>
                    <td>
                        <select name="TipAuta" id="tipauta">
                            <option value="1">
                                Kombi
                            </option>
                            <option value="0">
                                Putnicki
                            </option>
                        </select>
                    </td>
                </tr>
            </table>
            <button id="dodaj" type="button"><b>Dodaj</b></button>
        </div>
        <div id="DodavanjeVoznjeDispecer">
            <table border=1>

                <tr>
                    <td><b>Tip auta voznje</b></td>
                    <td>
                        <select name="TipAutaVoznje" id="tipauDisp">
                            <option>
                                Kombi
                            </option>
                            <option>
                                Putnicki
                            </option>
                        </select>
                    </td>
                </tr>
            </table>
            <button id="dodajVoznjuDispecer" type="button"><b>Izaberi vozaca</b></button>
        </div>
    </div>

    <div id="divVozac">
        <p><b>Wecome driver!</b></p>
        <button id="prikaziKorisnik2" type="button"><b>Prikazi podatke</b></button>
        <button id="izmjeniKorisnik2" type="button"><b>Izmeni podatke</b></button>
        <button id="prikaziVoznjeVozac" type="button"><b>Prikazi voznje na kojima sam</b></button>
        <button id="prikaziKreiraneVoznjeVozac" type="button"><b>Prikazi voznje bez vozaca</b></button>

        <div id="PrikaziFiltriraneVoznjeVozac"></div>
        <div id="KomentarNeuspjesnaVoznja">
            <div id="IzmjenaShow7"></div>
            <button id="neuspjesnaVoznjaPotvrdi" type="button"><b>Potvrdi komentar</b></button>
        </div>

        <div id="UspjesnaVoznjaNoComm">
            <div id="IzmjenaShow10"></div>
            <button id="potvrdiUnos" type="button"><b>Potvrdi unos odredista i iznosa</b></button>
        </div>
        <div id="PrikaziVoznjeVozac"></div>
        <div id="PrikaziKreiraneVoznjeVozac"></div>
        <div id="PrikazKorisnik2"></div>
        <div id="IzmjenaKorisnik2">
            <div id="IzmjenaShow2">
            </div>
            <button id="potvrdiIzmjenu2" type="button"><b>Izmeni podatke</b></button>
        </div>
    </div>

    <div id="map" style="width:700px;height:400px;"></div>
    <script>
        function myMap() {
            var mapCanvas = document.getElementById("map");
            var myCenter = new google.maps.LatLng(44.3, 20.4);
            var mapOptions = { center: myCenter, zoom: 8 };
            var map = new google.maps.Map(mapCanvas, mapOptions);
            google.maps.event.addListener(map, 'click', function (event) {
                placeMarker(map, event.latLng);
            });
        }

        let fulAdresa = '';

        function placeMarker(map, location) {
            var marker = new google.maps.Marker({
                position: location,
                map: map
            });

            var fullAdresa = displayLocation(location.lat(), location.lng());

            var dijelovi = fullAdresa.split(",");
            var ulicaIbroj = dijelovi[0];
            var grad = dijelovi[1]; //sa zipom
            var drzava = dijelovi[2];
            fulAdresa = location.lat() + "," + location.lng() + "," + ulicaIbroj + "," + grad + "," + drzava;  //za popunjavanje modela

            var infowindow = new google.maps.InfoWindow({
                content: 'Latitude: ' + location.lat() + '<br>Longitude: ' + location.lng() + '<br>Ulica i broj: ' + ulicaIbroj + '<br>Grad: ' + grad + '<br>Drzava: ' + drzava

            });
            infowindow.open(map, marker);
        }


        function displayLocation(latitude, longitude) {
            var request = new XMLHttpRequest();

            var method = 'GET';
            var url = 'http://maps.googleapis.com/maps/api/geocode/json?latlng='
                + latitude + ',' + longitude + '&sensor=true';
            var async = false;
            var address;
            request.open(method, url, async);
            request.onreadystatechange = function () {
                if (request.readyState == 4 && request.status == 200) {
                    var data = JSON.parse(request.responseText);
                    address = data.results[0];
                    var value = address.formatted_address.split(",");
                    count = value.length;
                    country = value[count - 1];
                    state = value[count - 2];
                    city = value[count - 3];
                }
            };
            request.send();
            return address.formatted_address;
        };

    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBrjeABCsOwW1rhi7eW6_b_fWF8OK2HeiA&callback=myMap"></script>

</body>
</html>